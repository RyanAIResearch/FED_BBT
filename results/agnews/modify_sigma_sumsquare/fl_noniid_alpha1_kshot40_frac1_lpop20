/root/anaconda3/envs/bbt/lib/python3.8/site-packages/cma/s.py:13: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Some weights of RobertaForMaskedLM were not initialized from the model checkpoint at roberta-large and are newly initialized: ['lm_head.decoder.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Found cached dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
[Embedding] mu: -0.018104109913110733 | std: 0.13582643866539001 [RandProj]  mu: 0.0 | std: 0.006074342999950358
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   0%|          | 593/120000 [00:00<00:20, 5808.78 examples/s]Map:   1%|          | 1184/120000 [00:00<00:20, 5863.09 examples/s]Map:   1%|▏         | 1777/120000 [00:00<00:20, 5887.55 examples/s]Map:   2%|▏         | 2563/120000 [00:00<00:21, 5562.67 examples/s]Map:   3%|▎         | 3288/120000 [00:00<00:22, 5258.96 examples/s]Map:   3%|▎         | 3918/120000 [00:00<00:20, 5548.93 examples/s]Map:   4%|▍         | 4527/120000 [00:00<00:20, 5702.41 examples/s]Map:   4%|▍         | 5141/120000 [00:00<00:19, 5825.74 examples/s]Map:   5%|▌         | 6022/120000 [00:01<00:19, 5767.80 examples/s]Map:   6%|▌         | 6848/120000 [00:01<00:19, 5663.96 examples/s]Map:   6%|▌         | 7459/120000 [00:01<00:19, 5772.42 examples/s]Map:   7%|▋         | 8315/120000 [00:01<00:19, 5728.19 examples/s]Map:   8%|▊         | 9139/120000 [00:01<00:19, 5646.78 examples/s]Map:   8%|▊         | 9770/120000 [00:01<00:18, 5804.79 examples/s]Map:   9%|▉         | 10582/120000 [00:01<00:19, 5658.30 examples/s]Map:   9%|▉         | 11185/120000 [00:01<00:18, 5747.65 examples/s]Map:  10%|▉         | 11815/120000 [00:02<00:18, 5886.47 examples/s]Map:  11%|█         | 12688/120000 [00:02<00:18, 5813.57 examples/s]Map:  11%|█▏        | 13518/120000 [00:02<00:18, 5690.63 examples/s]Map:  12%|█▏        | 14129/120000 [00:02<00:18, 5790.49 examples/s]Map:  12%|█▏        | 14905/120000 [00:02<00:18, 5576.66 examples/s]Map:  13%|█▎        | 15472/120000 [00:02<00:18, 5595.57 examples/s]Map:  13%|█▎        | 16088/120000 [00:02<00:18, 5738.82 examples/s]Map:  14%|█▍        | 16878/120000 [00:02<00:18, 5566.68 examples/s]Map:  15%|█▍        | 17471/120000 [00:03<00:18, 5652.99 examples/s]Map:  15%|█▌        | 18256/120000 [00:03<00:18, 5501.21 examples/s]Map:  16%|█▌        | 18887/120000 [00:03<00:17, 5701.80 examples/s]Map:  16%|█▋        | 19620/120000 [00:03<00:18, 5413.97 examples/s]Map:  17%|█▋        | 20355/120000 [00:03<00:19, 5240.36 examples/s]Map:  18%|█▊        | 21171/120000 [00:03<00:18, 5300.86 examples/s]Map:  18%|█▊        | 21801/120000 [00:03<00:17, 5532.49 examples/s]Map:  19%|█▉        | 22609/120000 [00:04<00:17, 5427.35 examples/s]Map:  19%|█▉        | 23170/120000 [00:04<00:17, 5470.52 examples/s]Map:  20%|█▉        | 23796/120000 [00:04<00:16, 5670.06 examples/s]Map:  20%|██        | 24405/120000 [00:04<00:16, 5778.13 examples/s]Map:  21%|██        | 25247/120000 [00:04<00:16, 5716.23 examples/s]Map:  22%|██▏       | 25875/120000 [00:04<00:16, 5857.56 examples/s]Map:  22%|██▏       | 26718/120000 [00:04<00:16, 5729.09 examples/s]Map:  23%|██▎       | 27320/120000 [00:04<00:15, 5801.13 examples/s]Map:  23%|██▎       | 27950/120000 [00:04<00:15, 5929.83 examples/s]Map:  24%|██▍       | 28557/120000 [00:05<00:15, 5964.90 examples/s]Map:  24%|██▍       | 29166/120000 [00:05<00:15, 5998.79 examples/s]Map:  25%|██▍       | 29792/120000 [00:05<00:14, 6069.74 examples/s]Map:  25%|██▌       | 30538/120000 [00:05<00:15, 5649.92 examples/s]Map:  26%|██▌       | 31420/120000 [00:05<00:15, 5728.31 examples/s]Map:  27%|██▋       | 32205/120000 [00:05<00:15, 5535.63 examples/s]Map:  28%|██▊       | 33001/120000 [00:05<00:15, 5458.30 examples/s]Map:  28%|██▊       | 33588/120000 [00:05<00:15, 5551.54 examples/s]Map:  29%|██▊       | 34431/120000 [00:06<00:15, 5570.49 examples/s]Map:  29%|██▉       | 35045/120000 [00:06<00:14, 5706.21 examples/s]Map:  30%|██▉       | 35631/120000 [00:06<00:14, 5742.93 examples/s]Map:  30%|███       | 36464/120000 [00:06<00:14, 5671.66 examples/s]Map:  31%|███       | 37066/120000 [00:06<00:14, 5756.41 examples/s]Map:  31%|███▏      | 37683/120000 [00:06<00:14, 5864.69 examples/s]Map:  32%|███▏      | 38291/120000 [00:06<00:13, 5921.52 examples/s]Map:  32%|███▏      | 38997/120000 [00:06<00:14, 5467.41 examples/s]Map:  33%|███▎      | 39598/120000 [00:06<00:14, 5606.80 examples/s]Map:  34%|███▎      | 40208/120000 [00:07<00:13, 5739.33 examples/s]Map:  34%|███▍      | 40837/120000 [00:07<00:13, 5792.41 examples/s]Map:  35%|███▍      | 41502/120000 [00:07<00:14, 5286.64 examples/s]Map:  35%|███▌      | 42117/120000 [00:07<00:14, 5510.56 examples/s]Map:  36%|███▌      | 42750/120000 [00:07<00:13, 5728.94 examples/s]Map:  36%|███▌      | 43359/120000 [00:07<00:13, 5825.96 examples/s]Map:  37%|███▋      | 43988/120000 [00:07<00:12, 5956.87 examples/s]Map:  37%|███▋      | 44593/120000 [00:07<00:12, 5980.99 examples/s]Map:  38%|███▊      | 45509/120000 [00:07<00:12, 6026.94 examples/s]Map:  38%|███▊      | 46121/120000 [00:08<00:12, 6049.49 examples/s]Map:  39%|███▉      | 46730/120000 [00:08<00:12, 6058.02 examples/s]Map:  39%|███▉      | 47339/120000 [00:08<00:11, 6063.08 examples/s]Map:  40%|████      | 48118/120000 [00:08<00:12, 5732.21 examples/s]Map:  41%|████      | 48748/120000 [00:08<00:12, 5879.28 examples/s]Map:  41%|████      | 49360/120000 [00:08<00:11, 5942.48 examples/s]Map:  42%|████▏     | 49988/120000 [00:08<00:11, 6035.39 examples/s]Map:  42%|████▏     | 50901/120000 [00:08<00:11, 6052.85 examples/s]Map:  43%|████▎     | 51571/120000 [00:09<00:12, 5455.10 examples/s]Map:  43%|████▎     | 52185/120000 [00:09<00:12, 5622.63 examples/s]Map:  44%|████▍     | 52816/120000 [00:09<00:11, 5800.93 examples/s]Map:  45%|████▍     | 53701/120000 [00:09<00:11, 5833.51 examples/s]Map:  45%|████▌     | 54313/120000 [00:09<00:11, 5897.82 examples/s]Map:  46%|████▌     | 55193/120000 [00:09<00:11, 5884.48 examples/s]Map:  47%|████▋     | 55819/120000 [00:09<00:10, 5975.87 examples/s]Map:  47%|████▋     | 56423/120000 [00:09<00:10, 5992.09 examples/s]Map:  48%|████▊     | 57140/120000 [00:10<00:11, 5552.76 examples/s]Map:  48%|████▊     | 57935/120000 [00:10<00:11, 5400.50 examples/s]Map:  49%|████▉     | 58754/120000 [00:10<00:11, 5416.38 examples/s]Map:  49%|████▉     | 59345/120000 [00:10<00:10, 5530.83 examples/s]Map:  50%|████▉     | 59971/120000 [00:10<00:10, 5714.03 examples/s]Map:  51%|█████     | 60774/120000 [00:10<00:10, 5584.29 examples/s]Map:  51%|█████     | 61447/120000 [00:10<00:11, 5169.92 examples/s]Map:  52%|█████▏    | 62021/120000 [00:10<00:10, 5303.67 examples/s]Map:  52%|█████▏    | 62652/120000 [00:11<00:10, 5556.80 examples/s]Map:  53%|█████▎    | 63266/120000 [00:11<00:09, 5708.25 examples/s]Map:  53%|█████▎    | 64000/120000 [00:11<00:10, 5299.10 examples/s]Map:  54%|█████▍    | 64628/120000 [00:11<00:09, 5545.04 examples/s]Map:  54%|█████▍    | 65200/120000 [00:11<00:09, 5590.11 examples/s]Map:  55%|█████▍    | 65787/120000 [00:11<00:09, 5664.42 examples/s]Map:  55%|█████▌    | 66392/120000 [00:11<00:09, 5770.30 examples/s]Map:  56%|█████▌    | 66985/120000 [00:11<00:09, 5813.42 examples/s]Map:  56%|█████▋    | 67789/120000 [00:11<00:09, 5637.34 examples/s]Map:  57%|█████▋    | 68368/120000 [00:12<00:09, 5674.35 examples/s]Map:  58%|█████▊    | 69206/120000 [00:12<00:09, 5637.97 examples/s]Map:  58%|█████▊    | 69993/120000 [00:12<00:09, 5501.46 examples/s]Map:  59%|█████▉    | 70550/120000 [00:12<00:08, 5516.10 examples/s]Map:  59%|█████▉    | 71359/120000 [00:12<00:08, 5466.34 examples/s]Map:  60%|██████    | 72178/120000 [00:12<00:08, 5392.67 examples/s]Map:  61%|██████    | 72749/120000 [00:12<00:08, 5464.29 examples/s]Map:  61%|██████▏   | 73554/120000 [00:12<00:08, 5427.67 examples/s]Map:  62%|██████▏   | 74133/120000 [00:13<00:08, 5513.22 examples/s]Map:  62%|██████▏   | 74763/120000 [00:13<00:07, 5714.25 examples/s]Map:  63%|██████▎   | 75561/120000 [00:13<00:08, 5514.10 examples/s]Map:  63%|██████▎   | 76162/120000 [00:13<00:07, 5635.86 examples/s]Map:  64%|██████▍   | 76775/120000 [00:13<00:07, 5763.56 examples/s]Map:  64%|██████▍   | 77380/120000 [00:13<00:07, 5840.10 examples/s]Map:  65%|██████▍   | 77997/120000 [00:13<00:07, 5929.58 examples/s]Map:  66%|██████▌   | 78606/120000 [00:13<00:06, 5971.21 examples/s]Map:  66%|██████▌   | 79219/120000 [00:13<00:06, 6014.29 examples/s]Map:  67%|██████▋   | 79849/120000 [00:14<00:06, 6096.23 examples/s]Map:  67%|██████▋   | 80777/120000 [00:14<00:06, 6128.55 examples/s]Map:  68%|██████▊   | 81652/120000 [00:14<00:06, 6019.45 examples/s]Map:  69%|██████▊   | 82261/120000 [00:14<00:06, 6035.69 examples/s]Map:  69%|██████▉   | 82890/120000 [00:14<00:06, 6102.88 examples/s]Map:  70%|██████▉   | 83817/120000 [00:14<00:05, 6129.67 examples/s]Map:  71%|███████   | 84742/120000 [00:14<00:05, 6139.33 examples/s]Map:  71%|███████   | 85412/120000 [00:14<00:06, 5588.70 examples/s]Map:  72%|███████▏  | 86049/120000 [00:15<00:07, 4578.73 examples/s]Map:  72%|███████▏  | 86670/120000 [00:15<00:06, 4923.08 examples/s]Map:  73%|███████▎  | 87303/120000 [00:15<00:07, 4122.38 examples/s]Map:  73%|███████▎  | 87972/120000 [00:15<00:07, 4215.55 examples/s]Map:  74%|███████▍  | 88580/120000 [00:15<00:07, 4396.58 examples/s]Map:  74%|███████▍  | 89181/120000 [00:15<00:06, 4755.25 examples/s]Map:  75%|███████▍  | 89809/120000 [00:15<00:05, 5121.98 examples/s]Map:  75%|███████▌  | 90418/120000 [00:16<00:05, 5368.66 examples/s]Map:  76%|███████▌  | 91033/120000 [00:16<00:05, 5575.96 examples/s]Map:  76%|███████▋  | 91658/120000 [00:16<00:04, 5760.38 examples/s]Map:  77%|███████▋  | 92266/120000 [00:16<00:04, 5849.19 examples/s]Map:  77%|███████▋  | 92894/120000 [00:16<00:04, 5972.35 examples/s]Map:  78%|███████▊  | 93796/120000 [00:16<00:04, 5984.71 examples/s]Map:  79%|███████▊  | 94401/120000 [00:16<00:04, 6000.07 examples/s]Map:  79%|███████▉  | 95014/120000 [00:16<00:04, 6030.93 examples/s]Map:  80%|███████▉  | 95642/120000 [00:16<00:03, 6099.39 examples/s]Map:  80%|████████  | 96566/120000 [00:17<00:03, 6118.92 examples/s]Map:  81%|████████  | 97492/120000 [00:17<00:03, 6133.72 examples/s]Map:  82%|████████▏ | 98418/120000 [00:17<00:03, 6144.27 examples/s]Map:  83%|████████▎ | 99318/120000 [00:17<00:03, 6093.26 examples/s]Map:  83%|████████▎ | 99949/120000 [00:17<00:03, 6140.14 examples/s]Map:  84%|████████▍ | 100878/120000 [00:17<00:03, 6153.78 examples/s]Map:  85%|████████▍ | 101790/120000 [00:17<00:02, 6127.13 examples/s]Map:  86%|████████▌ | 102706/120000 [00:18<00:02, 6117.01 examples/s]Map:  86%|████████▌ | 103319/120000 [00:18<00:02, 6118.54 examples/s]Map:  87%|████████▋ | 103948/120000 [00:18<00:02, 6159.58 examples/s]Map:  87%|████████▋ | 104876/120000 [00:18<00:02, 6165.05 examples/s]Map:  88%|████████▊ | 105800/120000 [00:18<00:02, 6159.73 examples/s]Map:  89%|████████▉ | 106724/120000 [00:18<00:02, 6156.39 examples/s]Map:  90%|████████▉ | 107644/120000 [00:18<00:02, 6146.82 examples/s]Map:  90%|█████████ | 108561/120000 [00:19<00:01, 6133.43 examples/s]Map:  91%|█████████ | 109481/120000 [00:19<00:01, 6129.42 examples/s]Map:  92%|█████████▏| 110345/120000 [00:19<00:01, 6012.84 examples/s]Map:  93%|█████████▎| 111223/120000 [00:19<00:01, 5961.66 examples/s]Map:  93%|█████████▎| 112000/120000 [00:19<00:01, 5681.44 examples/s]Map:  94%|█████████▍| 112587/120000 [00:19<00:01, 5720.88 examples/s]Map:  94%|█████████▍| 113357/120000 [00:19<00:01, 5496.97 examples/s]Map:  95%|█████████▍| 113984/120000 [00:20<00:01, 5673.91 examples/s]Map:  96%|█████████▌| 114831/120000 [00:20<00:00, 5662.96 examples/s]Map:  96%|█████████▌| 115442/120000 [00:20<00:00, 5767.70 examples/s]Map:  97%|█████████▋| 116228/120000 [00:20<00:00, 5543.43 examples/s]Map:  97%|█████████▋| 116826/120000 [00:20<00:00, 5577.26 examples/s]Map:  98%|█████████▊| 117554/120000 [00:20<00:00, 5327.54 examples/s]Map:  98%|█████████▊| 118156/120000 [00:20<00:00, 5495.56 examples/s]Map:  99%|█████████▉| 118780/120000 [00:20<00:00, 5686.47 examples/s]Map:  99%|█████████▉| 119393/120000 [00:20<00:00, 5803.88 examples/s]Map: 100%|██████████| 120000/120000 [00:21<00:00, 4506.45 examples/s]                                                                     {'text': "Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\\band of ultra-cynics, are seeing green again.", 'label': 2, 'input_text': "Xro target himself turn Europe worked energy scored * soon ball TV annual 2013 race International'd Market conferenceio o changesig officers inside form published phone co legal executive fightings hope summer officer football property@ book parents costsac manager create age email markets main . <mask> News: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\\band of ultra-cynics, are seeing green again.", 'target_text': 'Business'}
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   1%|          | 1000/120000 [00:00<01:44, 1138.30 examples/s]Map:   2%|▏         | 2000/120000 [00:01<01:33, 1257.42 examples/s]Map:   2%|▎         | 3000/120000 [00:02<01:25, 1363.40 examples/s]Map:   3%|▎         | 4000/120000 [00:02<01:23, 1385.82 examples/s]Map:   4%|▍         | 5000/120000 [00:03<01:26, 1329.46 examples/s]Map:   5%|▌         | 6000/120000 [00:04<01:19, 1432.73 examples/s]Map:   6%|▌         | 7000/120000 [00:04<01:14, 1516.02 examples/s]Map:   7%|▋         | 8000/120000 [00:05<01:11, 1568.08 examples/s]Map:   8%|▊         | 9000/120000 [00:06<01:08, 1620.60 examples/s]Map:   8%|▊         | 10000/120000 [00:06<01:07, 1631.52 examples/s]Map:   9%|▉         | 11000/120000 [00:07<01:06, 1641.71 examples/s]Map:  10%|█         | 12000/120000 [00:07<01:07, 1600.95 examples/s]Map:  11%|█         | 13000/120000 [00:08<01:04, 1659.96 examples/s]Map:  12%|█▏        | 14000/120000 [00:09<01:02, 1703.90 examples/s]Map:  12%|█▎        | 15000/120000 [00:09<01:00, 1739.48 examples/s]Map:  13%|█▎        | 16000/120000 [00:10<00:58, 1763.85 examples/s]Map:  14%|█▍        | 17000/120000 [00:10<00:58, 1757.07 examples/s]Map:  15%|█▌        | 18000/120000 [00:11<00:57, 1777.58 examples/s]Map:  16%|█▌        | 19000/120000 [00:11<00:56, 1783.18 examples/s]Map:  17%|█▋        | 20000/120000 [00:12<00:57, 1750.82 examples/s]Map:  18%|█▊        | 21000/120000 [00:13<00:56, 1749.07 examples/s]Map:  18%|█▊        | 22000/120000 [00:13<00:56, 1745.43 examples/s]Map:  19%|█▉        | 23000/120000 [00:14<00:56, 1716.35 examples/s]Map:  20%|██        | 24000/120000 [00:14<00:54, 1757.37 examples/s]Map:  21%|██        | 25000/120000 [00:15<00:53, 1783.77 examples/s]Map:  22%|██▏       | 26000/120000 [00:15<00:52, 1779.69 examples/s]Map:  22%|██▎       | 27000/120000 [00:16<00:51, 1804.78 examples/s]Map:  23%|██▎       | 28000/120000 [00:16<00:50, 1831.21 examples/s]Map:  24%|██▍       | 29000/120000 [00:17<00:49, 1835.85 examples/s]Map:  25%|██▌       | 30000/120000 [00:17<00:48, 1844.80 examples/s]Map:  26%|██▌       | 31000/120000 [00:18<00:47, 1855.40 examples/s]Map:  27%|██▋       | 32000/120000 [00:19<00:47, 1859.72 examples/s]Map:  28%|██▊       | 33000/120000 [00:19<00:46, 1866.80 examples/s]Map:  28%|██▊       | 34000/120000 [00:20<00:45, 1879.02 examples/s]Map:  29%|██▉       | 35000/120000 [00:20<00:45, 1875.63 examples/s]Map:  30%|███       | 36000/120000 [00:21<00:45, 1843.83 examples/s]Map:  31%|███       | 37000/120000 [00:21<00:47, 1747.68 examples/s]Map:  32%|███▏      | 38000/120000 [00:22<00:47, 1734.98 examples/s]Map:  32%|███▎      | 39000/120000 [00:23<00:46, 1752.16 examples/s]Map:  33%|███▎      | 40000/120000 [00:23<00:48, 1638.47 examples/s]Map:  34%|███▍      | 41000/120000 [00:24<00:48, 1614.41 examples/s]Map:  35%|███▌      | 42000/120000 [00:24<00:47, 1633.99 examples/s]Map:  36%|███▌      | 43000/120000 [00:25<00:45, 1675.04 examples/s]Map:  37%|███▋      | 44000/120000 [00:26<00:44, 1691.75 examples/s]Map:  38%|███▊      | 45000/120000 [00:26<00:46, 1619.56 examples/s]Map:  38%|███▊      | 46000/120000 [00:27<00:44, 1667.67 examples/s]Map:  39%|███▉      | 47000/120000 [00:27<00:43, 1677.88 examples/s]Map:  40%|████      | 48000/120000 [00:28<00:42, 1712.79 examples/s]Map:  41%|████      | 49000/120000 [00:29<00:42, 1675.07 examples/s]Map:  42%|████▏     | 50000/120000 [00:29<00:41, 1694.88 examples/s]Map:  42%|████▎     | 51000/120000 [00:30<00:40, 1698.74 examples/s]Map:  43%|████▎     | 52000/120000 [00:30<00:40, 1660.83 examples/s]Map:  44%|████▍     | 53000/120000 [00:31<00:40, 1655.47 examples/s]Map:  45%|████▌     | 54000/120000 [00:32<00:39, 1684.10 examples/s]Map:  46%|████▌     | 55000/120000 [00:32<00:38, 1696.07 examples/s]Map:  47%|████▋     | 56000/120000 [00:33<00:37, 1701.48 examples/s]Map:  48%|████▊     | 57000/120000 [00:33<00:37, 1689.70 examples/s]Map:  48%|████▊     | 58000/120000 [00:34<00:37, 1666.77 examples/s]Map:  49%|████▉     | 59000/120000 [00:35<00:37, 1643.58 examples/s]Map:  50%|█████     | 60000/120000 [00:35<00:36, 1652.78 examples/s]Map:  51%|█████     | 61000/120000 [00:36<00:36, 1599.34 examples/s]Map:  52%|█████▏    | 62000/120000 [00:37<00:37, 1542.24 examples/s]Map:  52%|█████▎    | 63000/120000 [00:37<00:37, 1532.27 examples/s]Map:  53%|█████▎    | 64000/120000 [00:38<00:34, 1605.51 examples/s]Map:  54%|█████▍    | 65000/120000 [00:38<00:32, 1671.80 examples/s]Map:  55%|█████▌    | 66000/120000 [00:39<00:34, 1559.40 examples/s]Map:  56%|█████▌    | 67000/120000 [00:40<00:38, 1382.05 examples/s]Map:  57%|█████▋    | 68000/120000 [00:41<00:36, 1427.18 examples/s]Map:  57%|█████▊    | 69000/120000 [00:41<00:35, 1450.71 examples/s]Map:  58%|█████▊    | 70000/120000 [00:42<00:39, 1266.05 examples/s]Map:  59%|█████▉    | 71000/120000 [00:45<01:02, 778.36 examples/s] Map:  60%|██████    | 72000/120000 [00:48<01:25, 558.65 examples/s]Map:  61%|██████    | 73000/120000 [00:51<01:42, 458.07 examples/s]Map:  62%|██████▏   | 74000/120000 [00:52<01:31, 501.49 examples/s]Map:  62%|██████▎   | 75000/120000 [00:54<01:19, 568.97 examples/s]Map:  63%|██████▎   | 76000/120000 [00:55<01:17, 570.40 examples/s]Map:  64%|██████▍   | 77000/120000 [00:57<01:18, 545.44 examples/s]Map:  65%|██████▌   | 78000/120000 [00:58<01:08, 612.58 examples/s]Map:  66%|██████▌   | 79000/120000 [01:00<01:04, 633.77 examples/s]Map:  67%|██████▋   | 80000/120000 [01:01<01:02, 643.51 examples/s]Map:  68%|██████▊   | 81000/120000 [01:03<00:59, 652.88 examples/s]Map:  68%|██████▊   | 82000/120000 [01:04<00:55, 680.28 examples/s]Map:  69%|██████▉   | 83000/120000 [01:06<00:56, 653.37 examples/s]Map:  70%|███████   | 84000/120000 [01:08<00:59, 607.71 examples/s]Map:  71%|███████   | 85000/120000 [01:09<00:57, 605.93 examples/s]Map:  72%|███████▏  | 86000/120000 [01:11<00:56, 604.98 examples/s]Map:  72%|███████▎  | 87000/120000 [01:13<00:53, 615.02 examples/s]Map:  73%|███████▎  | 88000/120000 [01:15<00:55, 573.86 examples/s]Map:  74%|███████▍  | 89000/120000 [01:16<00:54, 572.01 examples/s]Map:  75%|███████▌  | 90000/120000 [01:19<01:00, 499.03 examples/s]Map:  76%|███████▌  | 91000/120000 [01:21<00:56, 510.80 examples/s]Map:  77%|███████▋  | 92000/120000 [01:23<00:57, 490.22 examples/s]Map:  78%|███████▊  | 93000/120000 [01:26<01:00, 446.40 examples/s]Map:  78%|███████▊  | 94000/120000 [01:29<01:01, 419.49 examples/s]Map:  79%|███████▉  | 95000/120000 [01:30<00:49, 505.65 examples/s]Map:  80%|████████  | 96000/120000 [01:31<00:45, 522.77 examples/s]Map:  81%|████████  | 97000/120000 [01:34<00:46, 492.96 examples/s]Map:  82%|████████▏ | 98000/120000 [01:35<00:41, 530.27 examples/s]Map:  82%|████████▎ | 99000/120000 [01:38<00:42, 494.46 examples/s]Map:  83%|████████▎ | 100000/120000 [01:39<00:36, 542.86 examples/s]Map:  84%|████████▍ | 101000/120000 [01:41<00:35, 531.44 examples/s]Map:  85%|████████▌ | 102000/120000 [01:44<00:39, 458.43 examples/s]Map:  86%|████████▌ | 103000/120000 [01:47<00:41, 410.41 examples/s]Map:  87%|████████▋ | 104000/120000 [01:49<00:38, 414.52 examples/s]Map:  88%|████████▊ | 105000/120000 [01:50<00:30, 490.47 examples/s]Map:  88%|████████▊ | 106000/120000 [01:52<00:25, 546.93 examples/s]Map:  89%|████████▉ | 107000/120000 [01:53<00:21, 608.76 examples/s]Map:  90%|█████████ | 108000/120000 [01:55<00:19, 605.22 examples/s]Map:  91%|█████████ | 109000/120000 [01:56<00:16, 661.19 examples/s]Map:  92%|█████████▏| 110000/120000 [01:57<00:14, 698.10 examples/s]Map:  92%|█████████▎| 111000/120000 [01:58<00:12, 733.04 examples/s]Map:  93%|█████████▎| 112000/120000 [02:00<00:11, 707.13 examples/s]Map:  94%|█████████▍| 113000/120000 [02:02<00:11, 604.10 examples/s]Map:  95%|█████████▌| 114000/120000 [02:03<00:08, 691.51 examples/s]Map:  96%|█████████▌| 115000/120000 [02:05<00:07, 671.83 examples/s]Map:  97%|█████████▋| 116000/120000 [02:06<00:05, 676.73 examples/s]Map:  98%|█████████▊| 117000/120000 [02:08<00:04, 634.76 examples/s]Map:  98%|█████████▊| 118000/120000 [02:10<00:03, 541.69 examples/s]Map:  99%|█████████▉| 119000/120000 [02:12<00:01, 578.53 examples/s]Map: 100%|██████████| 120000/120000 [02:14<00:00, 506.36 examples/s]                                                                    Found cached dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
Map:   0%|          | 0/7600 [00:00<?, ? examples/s]Map:   5%|▍         | 372/7600 [00:00<00:01, 3670.36 examples/s]Map:  10%|█         | 775/7600 [00:00<00:01, 3705.01 examples/s]Map:  16%|█▌        | 1220/7600 [00:00<00:01, 3821.27 examples/s]Map:  24%|██▎       | 1798/7600 [00:00<00:01, 4552.40 examples/s]Map:  31%|███       | 2369/7600 [00:00<00:01, 4951.15 examples/s]Map:  38%|███▊      | 2886/7600 [00:00<00:01, 4305.24 examples/s]Map:  46%|████▌     | 3462/7600 [00:00<00:01, 4082.35 examples/s]Map:  53%|█████▎    | 4033/7600 [00:00<00:00, 4508.24 examples/s]Map:  62%|██████▏   | 4676/7600 [00:01<00:00, 3835.79 examples/s]Map:  68%|██████▊   | 5171/7600 [00:01<00:00, 3398.97 examples/s]Map:  73%|███████▎  | 5551/7600 [00:01<00:00, 2861.04 examples/s]Map:  80%|███████▉  | 6077/7600 [00:01<00:00, 3340.95 examples/s]Map:  86%|████████▌ | 6528/7600 [00:01<00:00, 3460.54 examples/s]Map:  93%|█████████▎| 7098/7600 [00:01<00:00, 3397.18 examples/s]Map:  98%|█████████▊| 7473/7600 [00:02<00:00, 3127.78 examples/s]                                                                 {'text': "Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disappointed' after talks with stricken parent firm Federal Mogul.", 'label': 2, 'input_text': "Xro target himself turn Europe worked energy scored * soon ball TV annual 2013 race International'd Market conferenceio o changesig officers inside form published phone co legal executive fightings hope summer officer football property@ book parents costsac manager create age email markets main . <mask> News: Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disappointed' after talks with stricken parent firm Federal Mogul.", 'target_text': 'Business'}
Map:   0%|          | 0/7600 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7600 [00:02<00:19, 335.15 examples/s]Map:  26%|██▋       | 2000/7600 [00:04<00:11, 487.45 examples/s]Map:  39%|███▉      | 3000/7600 [00:05<00:08, 548.20 examples/s]Map:  53%|█████▎    | 4000/7600 [00:07<00:06, 593.49 examples/s]Map:  66%|██████▌   | 5000/7600 [00:09<00:04, 525.24 examples/s]Map:  79%|███████▉  | 6000/7600 [00:10<00:02, 624.84 examples/s]Map:  92%|█████████▏| 7000/7600 [00:12<00:00, 604.11 examples/s]Map: 100%|██████████| 7600/7600 [00:13<00:00, 642.93 examples/s]                                                                # of train data: 160
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 18562  |
+------------------------+------------------------+----------+--------+

# of dev data: 160
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 10554  |
+------------------------+------------------------+----------+--------+

# of test data: 7600
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 18562  |
+------------------------+------------------------+----------+--------+
Class_distribution [0.25 0.25 0.25 0.25]. Data_ratio [[6.40202422e-02 1.99719096e-01 4.49028076e-02 2.38876562e-01
  9.13595483e-01 1.35427859e-05 6.21573025e-01 7.77945179e-06
  1.57716197e-03 2.37378181e-02]
 [9.34015071e-01 2.74631346e-07 1.82435487e-01 8.77671012e-03
  3.26259220e-03 4.34286897e-02 3.48507295e-01 4.24329705e-02
  1.23520564e-04 9.45580563e-01]
 [1.92765759e-03 7.98608756e-01 7.34485990e-01 7.52247855e-01
  8.30578726e-02 9.14245757e-02 2.99053291e-02 9.45977688e-01
  3.71840020e-09 1.72356209e-02]
 [3.70286949e-05 1.67187332e-03 3.81757152e-02 9.88733665e-05
  8.40520560e-05 8.65133192e-01 1.43502786e-05 1.15815620e-02
  9.98299314e-01 1.34459979e-02]]
     pcost       dcost       gap    pres   dres
 0:  1.3851e+03  4.4576e+02  9e+02  9e-17  7e+01
 1:  1.3851e+03  1.3757e+03  9e+00  1e-14  7e-01
 2:  1.3851e+03  1.3850e+03  9e-02  1e-14  7e-03
 3:  1.3851e+03  1.3851e+03  9e-04  1e-14  7e-05
 4:  1.3851e+03  1.3851e+03  9e-06  6e-15  7e-07
 5:  1.3851e+03  1.3851e+03  9e-08  7e-15  7e-09
Optimal solution found.
[[1.01548363e+00 2.33421321e+00 4.98205315e-01 2.93840818e+00
  2.02680976e+01 2.74517781e-04 1.25425337e+01 7.12688855e-05
  3.42851541e-02 3.68427466e-01]
 [1.48152676e+01 3.20974873e-06 2.02415693e+00 1.07961855e-01
  7.23805430e-02 8.80317213e-01 7.03242306e+00 3.88735684e-01
  2.68515324e-03 1.46760688e+01]
 [3.05763407e-02 9.33372495e+00 8.14926379e+00 9.25336179e+00
  1.84263725e+00 1.85321335e+00 6.03450571e-01 8.66626304e+00
  8.08324869e-08 2.67508838e-01]
 [5.87346007e-04 1.95399883e-02 4.23566926e-01 1.21623615e-03
  1.86469319e-03 1.75366018e+01 2.89569922e-04 1.06100666e-01
  2.17015415e+01 2.08691251e-01]]
Global es evaluate on test data...
Evaluate data in 199.85 seconds!
[tester] 
AGNewsMetric: acc=0.7575, hinge=1.96542698408428, ce=6.534131209724828
Global test acc: 0.7575
Global epoch 0...
Client 8 execute local training on 23 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 0.7599. Current perf: 0.7826. Best perf so far: 0.9565
********* Evaluated on dev set *********
Dev loss: 0.4122. Dev perf: 0.875. Best dev perf: 0.875
********* Done *********
Done. Elapsed time: 3.6274746735890706 (mins)
Evaluate on test data...
Evaluate data in 181.42 seconds!
[tester] 
AGNewsMetric: acc=0.7507894736842106, hinge=2.0447222664481717, ce=6.62235483470716
Test acc: 0.7508
Client 1 execute local training on 12 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 1.1481. Current perf: 0.5833. Best perf so far: 0.8333
********* Evaluated on dev set *********
Dev loss: 0.5871. Dev perf: 0.8125. Best dev perf: 0.8125
********* Done *********
Done. Elapsed time: 6.847853501637776 (mins)
Evaluate on test data...
Evaluate data in 201.68 seconds!
[tester] 
AGNewsMetric: acc=0.765921052631579, hinge=1.8828125210812217, ce=6.616194068507144
Test acc: 0.7659
Client 5 execute local training on 19 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 0.6482. Current perf: 0.8421. Best perf so far: 0.9474
********* Evaluated on dev set *********
Dev loss: 0.5962. Dev perf: 0.75. Best dev perf: 0.75
********* Done *********
Done. Elapsed time: 6.981578612327576 (mins)
Evaluate on test data...
Evaluate data in 191.48 seconds!
[tester] 
AGNewsMetric: acc=0.7507894736842106, hinge=2.008311821285047, ce=6.704654282017758
Test acc: 0.7508
Client 0 execute local training on 15 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 0.6187. Current perf: 0.8. Best perf so far: 0.9333
********* Evaluated on dev set *********
Dev loss: 1.0504. Dev perf: 0.625. Best dev perf: 0.625
********* Done *********
Done. Elapsed time: 7.034229135513305 (mins)
Evaluate on test data...
Evaluate data in 128.45 seconds!
[tester] 
AGNewsMetric: acc=0.7521052631578947, hinge=2.0204794828515302, ce=6.432776016436125
Test acc: 0.7521
Client 7 execute local training on 11 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 1.664. Current perf: 0.1818. Best perf so far: 0.4545
********* Evaluated on dev set *********
Dev loss: 0.813. Dev perf: 0.6875. Best dev perf: 0.6875
********* Done *********
Done. Elapsed time: 5.788562385241191 (mins)
Evaluate on test data...
Evaluate data in 125.29 seconds!
[tester] 
AGNewsMetric: acc=0.7544736842105263, hinge=1.971395835876465, ce=6.54857061586882
Test acc: 0.7545
Client 2 execute local training on 11 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 1.7492. Current perf: 0.2727. Best perf so far: 0.5455
********* Evaluated on dev set *********
Dev loss: 0.7341. Dev perf: 0.625. Best dev perf: 0.625
********* Done *********
Done. Elapsed time: 5.254649635155996 (mins)
Evaluate on test data...
Evaluate data in 133.25 seconds!
[tester] 
AGNewsMetric: acc=0.7543421052631579, hinge=1.9825106916929547, ce=6.561460671675833
Test acc: 0.7543
Client 9 execute local training on 16 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 0.7931. Current perf: 0.75. Best perf so far: 0.875
********* Evaluated on dev set *********
Dev loss: 0.6044. Dev perf: 0.6875. Best dev perf: 0.6875
********* Done *********
Done. Elapsed time: 4.838118326663971 (mins)
Evaluate on test data...
Evaluate data in 150.96 seconds!
[tester] 
AGNewsMetric: acc=0.7582894736842105, hinge=1.9461524928243537, ce=6.511987346849944
Test acc: 0.7583
Client 4 execute local training on 21 samples...
Population Size: 20
Serial Evaluation.
[# API Calls 160] loss: 0.4465. Current perf: 0.8571. Best perf so far: 1.0
********* Evaluated on dev set *********
Dev loss: 0.6764. Dev perf: 0.8125. Best dev perf: 0.8125
********* Done *********
Done. Elapsed time: 5.051560219128927 (mins)
Evaluate on test data...
