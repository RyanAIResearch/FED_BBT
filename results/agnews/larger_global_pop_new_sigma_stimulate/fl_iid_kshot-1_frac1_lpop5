/root/anaconda3/envs/bbt/lib/python3.8/site-packages/cma/s.py:13: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Some weights of RobertaForMaskedLM were not initialized from the model checkpoint at roberta-large and are newly initialized: ['lm_head.decoder.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Found cached dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
[Embedding] mu: -0.018104109913110733 | std: 0.13582643866539001 [RandProj]  mu: 0.0 | std: 0.006074342999950358
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   0%|          | 569/120000 [00:00<00:21, 5620.09 examples/s]Map:   1%|          | 1292/120000 [00:00<00:23, 5008.51 examples/s]Map:   2%|▏         | 1874/120000 [00:00<00:22, 5306.25 examples/s]Map:   2%|▏         | 2469/120000 [00:00<00:21, 5533.85 examples/s]Map:   3%|▎         | 3209/120000 [00:00<00:22, 5269.75 examples/s]Map:   3%|▎         | 3839/120000 [00:00<00:20, 5566.90 examples/s]Map:   4%|▎         | 4410/120000 [00:00<00:20, 5607.55 examples/s]Map:   4%|▍         | 4992/120000 [00:00<00:20, 5668.12 examples/s]Map:   5%|▍         | 5838/120000 [00:01<00:20, 5576.04 examples/s]Map:   5%|▌         | 6524/120000 [00:01<00:22, 5149.01 examples/s]Map:   6%|▌         | 7263/120000 [00:01<00:28, 3935.28 examples/s]Map:   7%|▋         | 7888/120000 [00:01<00:25, 4388.94 examples/s]Map:   7%|▋         | 8390/120000 [00:01<00:24, 4527.13 examples/s]Map:   7%|▋         | 8979/120000 [00:01<00:23, 4820.53 examples/s]Map:   8%|▊         | 9807/120000 [00:01<00:21, 5052.99 examples/s]Map:   9%|▊         | 10364/120000 [00:02<00:21, 5176.07 examples/s]Map:   9%|▉         | 10986/120000 [00:02<00:20, 5442.36 examples/s]Map:  10%|▉         | 11589/120000 [00:02<00:19, 5596.96 examples/s]Map:  10%|█         | 12331/120000 [00:02<00:20, 5280.57 examples/s]Map:  11%|█         | 12957/120000 [00:02<00:19, 5528.98 examples/s]Map:  11%|█▏        | 13591/120000 [00:02<00:21, 5043.99 examples/s]Map:  12%|█▏        | 14423/120000 [00:02<00:20, 5211.08 examples/s]Map:  13%|█▎        | 15154/120000 [00:02<00:20, 5099.92 examples/s]Map:  13%|█▎        | 15774/120000 [00:03<00:19, 5358.03 examples/s]Map:  14%|█▎        | 16446/120000 [00:03<00:20, 5018.89 examples/s]Map:  14%|█▍        | 17191/120000 [00:03<00:20, 4960.17 examples/s]Map:  15%|█▍        | 17700/120000 [00:03<00:20, 4988.81 examples/s]Map:  15%|█▌        | 18313/120000 [00:03<00:19, 5259.00 examples/s]Map:  16%|█▌        | 18942/120000 [00:03<00:18, 5527.65 examples/s]Map:  16%|█▋        | 19750/120000 [00:03<00:18, 5476.25 examples/s]Map:  17%|█▋        | 20317/120000 [00:03<00:18, 5521.53 examples/s]Map:  17%|█▋        | 20945/120000 [00:04<00:17, 5720.56 examples/s]Map:  18%|█▊        | 21546/120000 [00:04<00:16, 5799.51 examples/s]Map:  19%|█▊        | 22365/120000 [00:04<00:17, 5610.94 examples/s]Map:  19%|█▉        | 23119/120000 [00:04<00:18, 5267.85 examples/s]Map:  20%|█▉        | 23676/120000 [00:04<00:18, 5339.17 examples/s]Map:  20%|██        | 24257/120000 [00:04<00:17, 5457.52 examples/s]Map:  21%|██        | 24842/120000 [00:04<00:17, 5560.57 examples/s]Map:  21%|██▏       | 25509/120000 [00:04<00:18, 5090.48 examples/s]Map:  22%|██▏       | 26110/120000 [00:04<00:17, 5323.87 examples/s]Map:  22%|██▏       | 26707/120000 [00:05<00:16, 5493.82 examples/s]Map:  23%|██▎       | 27312/120000 [00:05<00:16, 5637.08 examples/s]Map:  23%|██▎       | 28000/120000 [00:05<00:17, 5155.11 examples/s]Map:  24%|██▍       | 28622/120000 [00:05<00:16, 5429.07 examples/s]Map:  24%|██▍       | 29331/120000 [00:05<00:17, 5117.04 examples/s]Map:  25%|██▍       | 29875/120000 [00:05<00:17, 5196.26 examples/s]Map:  25%|██▌       | 30440/120000 [00:05<00:16, 5313.97 examples/s]Map:  26%|██▌       | 31246/120000 [00:05<00:16, 5331.96 examples/s]Map:  27%|██▋       | 31851/120000 [00:06<00:15, 5514.31 examples/s]Map:  27%|██▋       | 32417/120000 [00:06<00:15, 5550.30 examples/s]Map:  28%|██▊       | 33203/120000 [00:06<00:16, 5412.90 examples/s]Map:  28%|██▊       | 34021/120000 [00:06<00:15, 5422.70 examples/s]Map:  29%|██▉       | 34626/120000 [00:06<00:15, 5572.43 examples/s]Map:  30%|██▉       | 35448/120000 [00:06<00:15, 5537.08 examples/s]Map:  30%|███       | 36178/120000 [00:06<00:15, 5312.95 examples/s]Map:  31%|███       | 36806/120000 [00:06<00:15, 5541.06 examples/s]Map:  31%|███       | 37414/120000 [00:07<00:14, 5675.39 examples/s]Map:  32%|███▏      | 38178/120000 [00:07<00:14, 5466.51 examples/s]Map:  32%|███▏      | 38754/120000 [00:07<00:14, 5537.28 examples/s]Map:  33%|███▎      | 39555/120000 [00:07<00:15, 5341.58 examples/s]Map:  33%|███▎      | 40123/120000 [00:07<00:14, 5422.80 examples/s]Map:  34%|███▍      | 40976/120000 [00:07<00:14, 5508.87 examples/s]Map:  35%|███▍      | 41573/120000 [00:07<00:13, 5619.60 examples/s]Map:  35%|███▌      | 42313/120000 [00:07<00:14, 5188.19 examples/s]Map:  36%|███▌      | 42939/120000 [00:08<00:14, 5444.97 examples/s]Map:  36%|███▋      | 43543/120000 [00:08<00:13, 5594.76 examples/s]Map:  37%|███▋      | 44150/120000 [00:08<00:13, 5719.88 examples/s]Map:  37%|███▋      | 44778/120000 [00:08<00:12, 5872.93 examples/s]Map:  38%|███▊      | 45386/120000 [00:08<00:12, 5927.95 examples/s]Map:  38%|███▊      | 46000/120000 [00:08<00:12, 5978.34 examples/s]Map:  39%|███▉      | 46620/120000 [00:08<00:12, 5901.69 examples/s]Map:  39%|███▉      | 47387/120000 [00:08<00:12, 5599.87 examples/s]Map:  40%|████      | 48000/120000 [00:08<00:12, 5728.30 examples/s]Map:  41%|████      | 48697/120000 [00:09<00:13, 5334.79 examples/s]Map:  41%|████      | 49282/120000 [00:09<00:12, 5443.90 examples/s]Map:  42%|████▏     | 49906/120000 [00:09<00:12, 5654.71 examples/s]Map:  42%|████▏     | 50765/120000 [00:09<00:12, 5677.06 examples/s]Map:  43%|████▎     | 51356/120000 [00:09<00:11, 5735.79 examples/s]Map:  43%|████▎     | 51985/120000 [00:09<00:11, 5882.12 examples/s]Map:  44%|████▍     | 52595/120000 [00:09<00:11, 5939.73 examples/s]Map:  44%|████▍     | 53204/120000 [00:09<00:11, 5978.10 examples/s]Map:  45%|████▍     | 53978/120000 [00:10<00:11, 5633.40 examples/s]Map:  46%|████▌     | 54808/120000 [00:10<00:11, 5596.26 examples/s]Map:  46%|████▌     | 55406/120000 [00:10<00:11, 5691.50 examples/s]Map:  47%|████▋     | 56138/120000 [00:10<00:11, 5324.53 examples/s]Map:  47%|████▋     | 56881/120000 [00:10<00:13, 4648.78 examples/s]Map:  48%|████▊     | 57664/120000 [00:10<00:12, 4816.12 examples/s]Map:  49%|████▊     | 58266/120000 [00:10<00:12, 5079.29 examples/s]Map:  49%|████▉     | 59037/120000 [00:11<00:11, 5096.73 examples/s]Map:  50%|████▉     | 59616/120000 [00:11<00:11, 5255.03 examples/s]Map:  50%|█████     | 60310/120000 [00:11<00:11, 5040.32 examples/s]Map:  51%|█████     | 60828/120000 [00:11<00:11, 5016.54 examples/s]Map:  51%|█████▏    | 61641/120000 [00:11<00:11, 5151.33 examples/s]Map:  52%|█████▏    | 62249/120000 [00:11<00:12, 4791.73 examples/s]Map:  52%|█████▏    | 62842/120000 [00:11<00:11, 5059.70 examples/s]Map:  53%|█████▎    | 63631/120000 [00:11<00:11, 5058.19 examples/s]Map:  53%|█████▎    | 64182/120000 [00:12<00:10, 5102.36 examples/s]Map:  54%|█████▍    | 64998/120000 [00:12<00:10, 5213.34 examples/s]Map:  55%|█████▍    | 65797/120000 [00:12<00:10, 5125.61 examples/s]Map:  55%|█████▌    | 66345/120000 [00:12<00:10, 5170.72 examples/s]Map:  56%|█████▌    | 66954/120000 [00:12<00:09, 5398.08 examples/s]Map:  56%|█████▋    | 67554/120000 [00:12<00:09, 5553.68 examples/s]Map:  57%|█████▋    | 68134/120000 [00:12<00:09, 5618.00 examples/s]Map:  57%|█████▋    | 68998/120000 [00:12<00:09, 5622.15 examples/s]Map:  58%|█████▊    | 69607/120000 [00:13<00:08, 5739.03 examples/s]Map:  59%|█████▊    | 70358/120000 [00:13<00:09, 5475.34 examples/s]Map:  59%|█████▉    | 71064/120000 [00:13<00:09, 5213.97 examples/s]Map:  60%|█████▉    | 71594/120000 [00:13<00:09, 5233.88 examples/s]Map:  60%|██████    | 72205/120000 [00:13<00:08, 5456.27 examples/s]Map:  61%|██████    | 72805/120000 [00:13<00:08, 5599.43 examples/s]Map:  61%|██████▏   | 73596/120000 [00:13<00:08, 5438.93 examples/s]Map:  62%|██████▏   | 74202/120000 [00:13<00:08, 5597.74 examples/s]Map:  62%|██████▏   | 74827/120000 [00:13<00:07, 5770.45 examples/s]Map:  63%|██████▎   | 75668/120000 [00:14<00:07, 5706.64 examples/s]Map:  64%|██████▍   | 76553/120000 [00:14<00:07, 5768.81 examples/s]Map:  64%|██████▍   | 77160/120000 [00:14<00:07, 5840.90 examples/s]Map:  65%|██████▍   | 77998/120000 [00:14<00:07, 5751.32 examples/s]Map:  66%|██████▌   | 78602/120000 [00:14<00:07, 5821.48 examples/s]Map:  66%|██████▌   | 79366/120000 [00:14<00:07, 5533.62 examples/s]Map:  67%|██████▋   | 79989/120000 [00:14<00:07, 5704.91 examples/s]Map:  67%|██████▋   | 80689/120000 [00:15<00:07, 5342.09 examples/s]Map:  68%|██████▊   | 81313/120000 [00:15<00:07, 5510.05 examples/s]Map:  68%|██████▊   | 81875/120000 [00:15<00:06, 5471.80 examples/s]Map:  69%|██████▊   | 82483/120000 [00:15<00:06, 5631.39 examples/s]Map:  69%|██████▉   | 83255/120000 [00:15<00:06, 5451.79 examples/s]Map:  70%|██████▉   | 83863/120000 [00:15<00:06, 5611.17 examples/s]Map:  70%|███████   | 84467/120000 [00:15<00:06, 5725.60 examples/s]Map:  71%|███████   | 85279/120000 [00:15<00:06, 5607.50 examples/s]Map:  72%|███████▏  | 85878/120000 [00:15<00:05, 5704.02 examples/s]Map:  72%|███████▏  | 86480/120000 [00:16<00:05, 5788.11 examples/s]Map:  73%|███████▎  | 87091/120000 [00:16<00:05, 5874.81 examples/s]Map:  73%|███████▎  | 87799/120000 [00:16<00:05, 5416.19 examples/s]Map:  74%|███████▎  | 88499/120000 [00:16<00:06, 5153.66 examples/s]Map:  74%|███████▍  | 89121/120000 [00:16<00:06, 4782.56 examples/s]Map:  75%|███████▍  | 89708/120000 [00:16<00:06, 5038.33 examples/s]Map:  75%|███████▌  | 90268/120000 [00:16<00:05, 5179.10 examples/s]Map:  76%|███████▌  | 90968/120000 [00:16<00:05, 4996.59 examples/s]Map:  76%|███████▌  | 91491/120000 [00:17<00:05, 5052.43 examples/s]Map:  77%|███████▋  | 92246/120000 [00:17<00:05, 5044.40 examples/s]Map:  77%|███████▋  | 92864/120000 [00:17<00:05, 5326.79 examples/s]Map:  78%|███████▊  | 93686/120000 [00:17<00:04, 5379.47 examples/s]Map:  79%|███████▊  | 94482/120000 [00:17<00:04, 5353.55 examples/s]Map:  79%|███████▉  | 95273/120000 [00:17<00:04, 5310.81 examples/s]Map:  80%|███████▉  | 95854/120000 [00:17<00:04, 5426.01 examples/s]Map:  80%|████████  | 96544/120000 [00:17<00:04, 5145.91 examples/s]Map:  81%|████████  | 97100/120000 [00:18<00:04, 5243.58 examples/s]Map:  81%|████████▏ | 97704/120000 [00:18<00:04, 5444.43 examples/s]Map:  82%|████████▏ | 98298/120000 [00:18<00:03, 5558.56 examples/s]Map:  82%|████████▏ | 98872/120000 [00:18<00:03, 5606.40 examples/s]Map:  83%|████████▎ | 99587/120000 [00:18<00:03, 5218.28 examples/s]Map:  84%|████████▎ | 100385/120000 [00:18<00:03, 5249.87 examples/s]Map:  84%|████████▍ | 100999/120000 [00:18<00:03, 5416.46 examples/s]Map:  85%|████████▍ | 101795/120000 [00:18<00:03, 5375.81 examples/s]Map:  85%|████████▌ | 102350/120000 [00:19<00:03, 5416.41 examples/s]Map:  86%|████████▌ | 102975/120000 [00:19<00:03, 5631.80 examples/s]Map:  87%|████████▋ | 103846/120000 [00:19<00:02, 5671.06 examples/s]Map:  87%|████████▋ | 104437/120000 [00:19<00:03, 4973.83 examples/s]Map:  88%|████████▊ | 105011/120000 [00:19<00:03, 4604.61 examples/s]Map:  88%|████████▊ | 105654/120000 [00:19<00:03, 4370.76 examples/s]Map:  88%|████████▊ | 106103/120000 [00:19<00:03, 4343.77 examples/s]Map:  89%|████████▉ | 106714/120000 [00:20<00:03, 4230.23 examples/s]Map:  89%|████████▉ | 107314/120000 [00:20<00:02, 4631.92 examples/s]Map:  90%|████████▉ | 107964/120000 [00:20<00:02, 4529.41 examples/s]Map:  90%|█████████ | 108504/120000 [00:20<00:02, 4736.68 examples/s]Map:  91%|█████████ | 109058/120000 [00:20<00:02, 4900.32 examples/s]Map:  91%|█████████▏| 109657/120000 [00:20<00:01, 5186.07 examples/s]Map:  92%|█████████▏| 110270/120000 [00:20<00:02, 4783.76 examples/s]Map:  92%|█████████▏| 110874/120000 [00:20<00:01, 5103.16 examples/s]Map:  93%|█████████▎| 111433/120000 [00:20<00:01, 5232.32 examples/s]Map:  93%|█████████▎| 111982/120000 [00:21<00:01, 5300.23 examples/s]Map:  94%|█████████▍| 112760/120000 [00:21<00:01, 5252.76 examples/s]Map:  94%|█████████▍| 113356/120000 [00:21<00:01, 5435.41 examples/s]Map:  95%|█████████▍| 113948/120000 [00:21<00:01, 5563.39 examples/s]Map:  95%|█████████▌| 114555/120000 [00:21<00:00, 5704.10 examples/s]Map:  96%|█████████▌| 115219/120000 [00:21<00:00, 5222.85 examples/s]Map:  97%|█████████▋| 115802/120000 [00:21<00:00, 5381.51 examples/s]Map:  97%|█████████▋| 116362/120000 [00:21<00:00, 5379.00 examples/s]Map:  98%|█████████▊| 117113/120000 [00:21<00:00, 5213.36 examples/s]Map:  98%|█████████▊| 117799/120000 [00:22<00:00, 4867.08 examples/s]Map:  99%|█████████▊| 118441/120000 [00:22<00:00, 4574.99 examples/s]Map:  99%|█████████▉| 119113/120000 [00:22<00:00, 4507.14 examples/s]Map: 100%|█████████▉| 119641/120000 [00:22<00:00, 4655.04 examples/s]                                                                     {'text': "Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\\band of ultra-cynics, are seeing green again.", 'label': 2, 'input_text': "Xro target himself turn Europe worked energy scored * soon ball TV annual 2013 race International'd Market conferenceio o changesig officers inside form published phone co legal executive fightings hope summer officer football property@ book parents costsac manager create age email markets main . <mask> News: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\\band of ultra-cynics, are seeing green again.", 'target_text': 'Business'}
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   1%|          | 1000/120000 [00:00<01:57, 1013.79 examples/s]Map:   2%|▏         | 2000/120000 [00:01<01:46, 1108.39 examples/s]Map:   2%|▎         | 3000/120000 [00:02<01:33, 1247.15 examples/s]Map:   3%|▎         | 4000/120000 [00:03<01:28, 1311.01 examples/s]Map:   4%|▍         | 5000/120000 [00:04<01:33, 1224.50 examples/s]Map:   5%|▌         | 6000/120000 [00:04<01:25, 1332.24 examples/s]Map:   6%|▌         | 7000/120000 [00:05<01:25, 1323.99 examples/s]Map:   7%|▋         | 8000/120000 [00:06<01:19, 1417.27 examples/s]Map:   8%|▊         | 9000/120000 [00:06<01:18, 1406.01 examples/s]Map:   8%|▊         | 10000/120000 [00:07<01:17, 1427.40 examples/s]Map:   9%|▉         | 11000/120000 [00:08<01:14, 1470.52 examples/s]Map:  10%|█         | 12000/120000 [00:08<01:16, 1406.44 examples/s]Map:  11%|█         | 13000/120000 [00:09<01:13, 1455.22 examples/s]Map:  12%|█▏        | 14000/120000 [00:10<01:11, 1479.66 examples/s]Map:  12%|█▎        | 15000/120000 [00:10<01:08, 1524.22 examples/s]Map:  13%|█▎        | 16000/120000 [00:11<01:10, 1485.71 examples/s]Map:  14%|█▍        | 17000/120000 [00:12<01:08, 1497.16 examples/s]Map:  15%|█▌        | 18000/120000 [00:12<01:09, 1470.76 examples/s]Map:  16%|█▌        | 19000/120000 [00:13<01:04, 1554.55 examples/s]Map:  17%|█▋        | 20000/120000 [00:14<01:04, 1554.64 examples/s]Map:  18%|█▊        | 21000/120000 [00:14<01:07, 1463.83 examples/s]Map:  18%|█▊        | 22000/120000 [00:15<01:16, 1280.79 examples/s]Map:  19%|█▉        | 23000/120000 [00:16<01:10, 1372.71 examples/s]Map:  20%|██        | 24000/120000 [00:17<01:04, 1477.93 examples/s]Map:  21%|██        | 25000/120000 [00:17<01:00, 1567.97 examples/s]Map:  22%|██▏       | 26000/120000 [00:18<00:58, 1613.07 examples/s]Map:  22%|██▎       | 27000/120000 [00:18<00:58, 1600.87 examples/s]Map:  23%|██▎       | 28000/120000 [00:19<00:58, 1580.19 examples/s]Map:  24%|██▍       | 29000/120000 [00:20<00:57, 1576.16 examples/s]Map:  25%|██▌       | 30000/120000 [00:20<00:55, 1612.00 examples/s]Map:  26%|██▌       | 31000/120000 [00:21<00:53, 1661.04 examples/s]Map:  27%|██▋       | 32000/120000 [00:21<00:53, 1633.65 examples/s]Map:  28%|██▊       | 33000/120000 [00:22<00:52, 1652.70 examples/s]Map:  28%|██▊       | 34000/120000 [00:23<00:51, 1678.72 examples/s]Map:  29%|██▉       | 35000/120000 [00:23<00:50, 1667.29 examples/s]Map:  30%|███       | 36000/120000 [00:24<00:51, 1638.55 examples/s]Map:  31%|███       | 37000/120000 [00:24<00:48, 1701.80 examples/s]Map:  32%|███▏      | 38000/120000 [00:25<00:46, 1759.78 examples/s]Map:  32%|███▎      | 39000/120000 [00:25<00:45, 1797.25 examples/s]Map:  33%|███▎      | 40000/120000 [00:26<00:51, 1550.86 examples/s]Map:  34%|███▍      | 41000/120000 [00:27<00:49, 1582.28 examples/s]Map:  35%|███▌      | 42000/120000 [00:28<00:51, 1522.75 examples/s]Map:  36%|███▌      | 43000/120000 [00:28<00:49, 1557.61 examples/s]Map:  37%|███▋      | 44000/120000 [00:29<00:48, 1571.19 examples/s]Map:  38%|███▊      | 45000/120000 [00:29<00:48, 1546.90 examples/s]Map:  38%|███▊      | 46000/120000 [00:30<00:47, 1572.19 examples/s]Map:  39%|███▉      | 47000/120000 [00:31<00:46, 1553.55 examples/s]Map:  40%|████      | 48000/120000 [00:31<00:45, 1589.87 examples/s]Map:  41%|████      | 49000/120000 [00:32<00:45, 1544.14 examples/s]Map:  42%|████▏     | 50000/120000 [00:33<00:45, 1554.42 examples/s]Map:  42%|████▎     | 51000/120000 [00:33<00:42, 1618.23 examples/s]Map:  43%|████▎     | 52000/120000 [00:34<00:41, 1646.82 examples/s]Map:  44%|████▍     | 53000/120000 [00:34<00:42, 1594.17 examples/s]Map:  45%|████▌     | 54000/120000 [00:35<00:42, 1555.44 examples/s]Map:  46%|████▌     | 55000/120000 [00:36<00:41, 1578.35 examples/s]Map:  47%|████▋     | 56000/120000 [00:36<00:38, 1646.21 examples/s]Map:  48%|████▊     | 57000/120000 [00:37<00:37, 1668.62 examples/s]Map:  48%|████▊     | 58000/120000 [00:38<00:38, 1615.77 examples/s]Map:  49%|████▉     | 59000/120000 [00:38<00:39, 1546.93 examples/s]Map:  50%|█████     | 60000/120000 [00:39<00:37, 1615.83 examples/s]Map:  51%|█████     | 61000/120000 [00:39<00:37, 1564.96 examples/s]Map:  52%|█████▏    | 62000/120000 [00:40<00:36, 1588.55 examples/s]Map:  52%|█████▎    | 63000/120000 [00:41<00:35, 1604.04 examples/s]Map:  53%|█████▎    | 64000/120000 [00:41<00:35, 1574.71 examples/s]Map:  54%|█████▍    | 65000/120000 [00:42<00:35, 1553.40 examples/s]Map:  55%|█████▌    | 66000/120000 [00:43<00:35, 1532.29 examples/s]Map:  56%|█████▌    | 67000/120000 [00:43<00:34, 1532.02 examples/s]Map:  57%|█████▋    | 68000/120000 [00:44<00:32, 1615.39 examples/s]Map:  57%|█████▊    | 69000/120000 [00:44<00:30, 1673.26 examples/s]Map:  58%|█████▊    | 70000/120000 [00:45<00:30, 1629.29 examples/s]Map:  59%|█████▉    | 71000/120000 [00:46<00:29, 1647.47 examples/s]Map:  60%|██████    | 72000/120000 [00:46<00:31, 1540.78 examples/s]Map:  61%|██████    | 73000/120000 [00:47<00:31, 1504.43 examples/s]Map:  62%|██████▏   | 74000/120000 [00:48<00:30, 1523.64 examples/s]Map:  62%|██████▎   | 75000/120000 [00:48<00:29, 1526.63 examples/s]Map:  63%|██████▎   | 76000/120000 [00:49<00:27, 1580.93 examples/s]Map:  64%|██████▍   | 77000/120000 [00:50<00:27, 1581.71 examples/s]Map:  65%|██████▌   | 78000/120000 [00:50<00:26, 1558.08 examples/s]Map:  66%|██████▌   | 79000/120000 [00:51<00:26, 1567.80 examples/s]Map:  67%|██████▋   | 80000/120000 [00:52<00:24, 1608.22 examples/s]Map:  68%|██████▊   | 81000/120000 [00:52<00:23, 1634.27 examples/s]Map:  68%|██████▊   | 82000/120000 [00:53<00:23, 1651.21 examples/s]Map:  69%|██████▉   | 83000/120000 [00:53<00:23, 1569.38 examples/s]Map:  70%|███████   | 84000/120000 [00:54<00:23, 1545.14 examples/s]Map:  71%|███████   | 85000/120000 [00:55<00:22, 1557.42 examples/s]Map:  72%|███████▏  | 86000/120000 [00:55<00:21, 1573.21 examples/s]Map:  72%|███████▎  | 87000/120000 [00:56<00:20, 1587.86 examples/s]Map:  73%|███████▎  | 88000/120000 [00:57<00:19, 1602.46 examples/s]Map:  74%|███████▍  | 89000/120000 [00:57<00:20, 1485.90 examples/s]Map:  75%|███████▌  | 90000/120000 [00:58<00:19, 1538.89 examples/s]Map:  76%|███████▌  | 91000/120000 [00:59<00:18, 1571.27 examples/s]Map:  77%|███████▋  | 92000/120000 [00:59<00:17, 1618.29 examples/s]Map:  78%|███████▊  | 93000/120000 [01:00<00:17, 1519.57 examples/s]Map:  78%|███████▊  | 94000/120000 [01:00<00:16, 1542.45 examples/s]Map:  79%|███████▉  | 95000/120000 [01:02<00:20, 1225.53 examples/s]Map:  80%|████████  | 96000/120000 [01:02<00:18, 1294.90 examples/s]Map:  81%|████████  | 97000/120000 [01:03<00:17, 1282.22 examples/s]Map:  82%|████████▏ | 98000/120000 [01:04<00:16, 1354.89 examples/s]Map:  82%|████████▎ | 99000/120000 [01:05<00:15, 1360.11 examples/s]Map:  83%|████████▎ | 100000/120000 [01:05<00:13, 1437.25 examples/s]Map:  84%|████████▍ | 101000/120000 [01:06<00:12, 1485.77 examples/s]Map:  85%|████████▌ | 102000/120000 [01:06<00:11, 1551.23 examples/s]Map:  86%|████████▌ | 103000/120000 [01:07<00:10, 1595.66 examples/s]Map:  87%|████████▋ | 104000/120000 [01:08<00:10, 1573.08 examples/s]Map:  88%|████████▊ | 105000/120000 [01:08<00:09, 1613.09 examples/s]Map:  88%|████████▊ | 106000/120000 [01:09<00:08, 1591.67 examples/s]Map:  89%|████████▉ | 107000/120000 [01:10<00:08, 1527.34 examples/s]Map:  90%|█████████ | 108000/120000 [01:10<00:09, 1331.95 examples/s]Map:  91%|█████████ | 109000/120000 [01:11<00:07, 1394.98 examples/s]Map:  92%|█████████▏| 110000/120000 [01:12<00:06, 1471.82 examples/s]Map:  92%|█████████▎| 111000/120000 [01:12<00:06, 1465.95 examples/s]Map:  93%|█████████▎| 112000/120000 [01:13<00:05, 1539.13 examples/s]Map:  94%|█████████▍| 113000/120000 [01:14<00:04, 1588.54 examples/s]Map:  95%|█████████▌| 114000/120000 [01:14<00:03, 1628.02 examples/s]Map:  96%|█████████▌| 115000/120000 [01:15<00:03, 1613.89 examples/s]Map:  97%|█████████▋| 116000/120000 [01:15<00:02, 1631.37 examples/s]Map:  98%|█████████▊| 117000/120000 [01:16<00:01, 1585.60 examples/s]Map:  98%|█████████▊| 118000/120000 [01:17<00:01, 1650.32 examples/s]Map:  99%|█████████▉| 119000/120000 [01:17<00:00, 1698.88 examples/s]Map: 100%|██████████| 120000/120000 [01:18<00:00, 1693.28 examples/s]                                                                     Found cached dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
Map:   0%|          | 0/7600 [00:00<?, ? examples/s]Map:   8%|▊         | 619/7600 [00:00<00:01, 6110.66 examples/s]Map:  18%|█▊        | 1367/7600 [00:00<00:01, 5341.64 examples/s]Map:  27%|██▋       | 2023/7600 [00:00<00:01, 4837.22 examples/s]Map:  34%|███▍      | 2584/7600 [00:00<00:00, 5081.21 examples/s]Map:  41%|████▏     | 3141/7600 [00:00<00:00, 5232.82 examples/s]Map:  48%|████▊     | 3685/7600 [00:00<00:00, 5293.00 examples/s]Map:  59%|█████▊    | 4453/7600 [00:00<00:00, 5222.09 examples/s]Map:  68%|██████▊   | 5187/7600 [00:01<00:00, 4945.60 examples/s]Map:  76%|███████▋  | 5805/7600 [00:01<00:00, 5252.63 examples/s]Map:  84%|████████▍ | 6407/7600 [00:01<00:00, 5452.07 examples/s]Map:  94%|█████████▍| 7161/7600 [00:01<00:00, 5295.91 examples/s]                                                                 {'text': "Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disappointed' after talks with stricken parent firm Federal Mogul.", 'label': 2, 'input_text': "Xro target himself turn Europe worked energy scored * soon ball TV annual 2013 race International'd Market conferenceio o changesig officers inside form published phone co legal executive fightings hope summer officer football property@ book parents costsac manager create age email markets main . <mask> News: Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disappointed' after talks with stricken parent firm Federal Mogul.", 'target_text': 'Business'}
Map:   0%|          | 0/7600 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7600 [00:00<00:03, 1662.61 examples/s]Map:  26%|██▋       | 2000/7600 [00:01<00:03, 1675.84 examples/s]Map:  39%|███▉      | 3000/7600 [00:01<00:02, 1687.63 examples/s]Map:  53%|█████▎    | 4000/7600 [00:02<00:02, 1696.72 examples/s]Map:  66%|██████▌   | 5000/7600 [00:02<00:01, 1713.78 examples/s]Map:  79%|███████▉  | 6000/7600 [00:03<00:00, 1698.90 examples/s]Map:  92%|█████████▏| 7000/7600 [00:04<00:00, 1692.07 examples/s]Map: 100%|██████████| 7600/7600 [00:04<00:00, 1653.34 examples/s]                                                                 # of train data: 108000
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 10554  |
+------------------------+------------------------+----------+--------+

# of dev data: 12000
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 18562  |
+------------------------+------------------------+----------+--------+

# of test data: 7600
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 18562  |
+------------------------+------------------------+----------+--------+
Global es evaluate on test data...
Evaluate data in 260.83 seconds!
[tester] 
AGNewsMetric: acc=0.7575, hinge=1.96542698408428, ce=6.534131209724828
Global test acc: 0.7575
Global epoch 0...
Client 8 execute local training on 10800 samples...
Population Size: 5
Serial Evaluation.
Traceback (most recent call last):
  File "FedBBT_larger_global_pop.py", line 313, in <module>
    fitnesses = [model_forward_api.eval(x) for x in solutions]
  File "FedBBT_larger_global_pop.py", line 313, in <listcomp>
    fitnesses = [model_forward_api.eval(x) for x in solutions]
  File "/workspace/Black-Box-Tuning/LMForwardAPI.py", line 454, in eval
    logits = self.model(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/Black-Box-Tuning/models/modeling_roberta.py", line 960, in forward
    outputs = self.roberta(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/Black-Box-Tuning/models/modeling_roberta.py", line 708, in forward
    embedding_output = self.embeddings(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/Black-Box-Tuning/models/modeling_roberta.py", line 126, in forward
    position_embeddings = self.position_embeddings(position_ids)
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 15.00 GiB (GPU 0; 79.19 GiB total capacity; 48.51 GiB already allocated; 134.88 MiB free; 48.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
