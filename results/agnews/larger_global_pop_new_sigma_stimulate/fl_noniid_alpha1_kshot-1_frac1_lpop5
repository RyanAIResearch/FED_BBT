/root/anaconda3/envs/bbt/lib/python3.8/site-packages/cma/s.py:13: UserWarning: Could not import matplotlib.pyplot, therefore ``cma.plot()`` etc. is not available
  _warnings.warn('Could not import matplotlib.pyplot, therefore'
Some weights of RobertaForMaskedLM were not initialized from the model checkpoint at roberta-large and are newly initialized: ['lm_head.decoder.bias']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Found cached dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
[Embedding] mu: -0.018104109913110733 | std: 0.13582643866539001 [RandProj]  mu: 0.0 | std: 0.006074342999950358
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   0%|          | 419/120000 [00:00<00:29, 4094.76 examples/s]Map:   1%|          | 858/120000 [00:00<00:29, 4054.28 examples/s]Map:   1%|▏         | 1515/120000 [00:00<00:28, 4108.13 examples/s]Map:   2%|▏         | 2117/120000 [00:00<00:24, 4744.58 examples/s]Map:   2%|▏         | 2706/120000 [00:00<00:22, 5111.52 examples/s]Map:   3%|▎         | 3541/120000 [00:00<00:22, 5239.22 examples/s]Map:   3%|▎         | 4076/120000 [00:00<00:22, 5268.60 examples/s]Map:   4%|▍         | 4708/120000 [00:00<00:20, 5564.86 examples/s]Map:   4%|▍         | 5273/120000 [00:01<00:20, 5586.60 examples/s]Map:   5%|▍         | 5905/120000 [00:01<00:19, 5798.64 examples/s]Map:   5%|▌         | 6519/120000 [00:01<00:19, 5896.67 examples/s]Map:   6%|▌         | 7316/120000 [00:01<00:20, 5588.51 examples/s]Map:   7%|▋         | 8119/120000 [00:01<00:20, 5457.24 examples/s]Map:   7%|▋         | 8752/120000 [00:01<00:19, 5672.69 examples/s]Map:   8%|▊         | 9554/120000 [00:01<00:19, 5536.27 examples/s]Map:   8%|▊         | 10163/120000 [00:01<00:19, 5670.85 examples/s]Map:   9%|▉         | 10796/120000 [00:01<00:18, 5841.92 examples/s]Map:  10%|▉         | 11619/120000 [00:02<00:18, 5711.61 examples/s]Map:  10%|█         | 12279/120000 [00:02<00:20, 5264.13 examples/s]Map:  11%|█         | 12913/120000 [00:02<00:19, 5523.98 examples/s]Map:  11%|█▏        | 13528/120000 [00:02<00:18, 5683.14 examples/s]Map:  12%|█▏        | 14140/120000 [00:02<00:18, 5798.18 examples/s]Map:  12%|█▏        | 14772/120000 [00:02<00:17, 5939.10 examples/s]Map:  13%|█▎        | 15389/120000 [00:02<00:17, 6000.56 examples/s]Map:  13%|█▎        | 16000/120000 [00:02<00:17, 5931.48 examples/s]Map:  14%|█▍        | 16811/120000 [00:03<00:18, 5729.46 examples/s]Map:  15%|█▍        | 17525/120000 [00:03<00:19, 5334.97 examples/s]Map:  15%|█▌        | 18089/120000 [00:03<00:18, 5375.42 examples/s]Map:  16%|█▌        | 18797/120000 [00:03<00:19, 5075.11 examples/s]Map:  16%|█▌        | 19376/120000 [00:03<00:19, 5061.86 examples/s]Map:  17%|█▋        | 20120/120000 [00:03<00:20, 4959.36 examples/s]Map:  17%|█▋        | 20643/120000 [00:03<00:19, 5007.73 examples/s]Map:  18%|█▊        | 21254/120000 [00:03<00:18, 5287.32 examples/s]Map:  18%|█▊        | 21888/120000 [00:04<00:17, 5567.80 examples/s]Map:  19%|█▉        | 22593/120000 [00:04<00:18, 5226.34 examples/s]Map:  20%|█▉        | 23410/120000 [00:04<00:18, 5204.03 examples/s]Map:  20%|██        | 24013/120000 [00:04<00:19, 4819.65 examples/s]Map:  20%|██        | 24565/120000 [00:04<00:19, 4981.39 examples/s]Map:  21%|██        | 25329/120000 [00:04<00:18, 5016.74 examples/s]Map:  22%|██▏       | 25913/120000 [00:04<00:18, 5213.70 examples/s]Map:  22%|██▏       | 26498/120000 [00:04<00:17, 5375.45 examples/s]Map:  23%|██▎       | 27289/120000 [00:05<00:17, 5335.37 examples/s]Map:  23%|██▎       | 27878/120000 [00:05<00:16, 5474.21 examples/s]Map:  24%|██▎       | 28482/120000 [00:05<00:16, 5619.89 examples/s]Map:  24%|██▍       | 29097/120000 [00:05<00:15, 5763.07 examples/s]Map:  25%|██▍       | 29847/120000 [00:05<00:16, 5479.03 examples/s]Map:  25%|██▌       | 30579/120000 [00:05<00:17, 5181.40 examples/s]Map:  26%|██▌       | 31164/120000 [00:05<00:16, 5343.41 examples/s]Map:  26%|██▋       | 31740/120000 [00:05<00:16, 5386.19 examples/s]Map:  27%|██▋       | 32455/120000 [00:06<00:17, 5126.78 examples/s]Map:  28%|██▊       | 33049/120000 [00:06<00:16, 5326.77 examples/s]Map:  28%|██▊       | 33679/120000 [00:06<00:15, 5581.04 examples/s]Map:  29%|██▊       | 34288/120000 [00:06<00:14, 5718.96 examples/s]Map:  29%|██▉       | 35089/120000 [00:06<00:15, 5576.17 examples/s]Map:  30%|██▉       | 35675/120000 [00:06<00:15, 5523.29 examples/s]Map:  30%|███       | 36275/120000 [00:06<00:14, 5646.12 examples/s]Map:  31%|███       | 37031/120000 [00:06<00:15, 5356.31 examples/s]Map:  31%|███▏      | 37664/120000 [00:06<00:14, 5600.80 examples/s]Map:  32%|███▏      | 38279/120000 [00:07<00:14, 5745.08 examples/s]Map:  32%|███▏      | 38879/120000 [00:07<00:13, 5811.93 examples/s]Map:  33%|███▎      | 39647/120000 [00:07<00:14, 5468.34 examples/s]Map:  34%|███▎      | 40356/120000 [00:07<00:15, 5211.97 examples/s]Map:  34%|███▍      | 40938/120000 [00:07<00:14, 5361.60 examples/s]Map:  35%|███▍      | 41703/120000 [00:07<00:14, 5269.21 examples/s]Map:  35%|███▌      | 42478/120000 [00:07<00:14, 5214.14 examples/s]Map:  36%|███▌      | 43315/120000 [00:08<00:14, 5285.67 examples/s]Map:  37%|███▋      | 43935/120000 [00:08<00:13, 5496.28 examples/s]Map:  37%|███▋      | 44777/120000 [00:08<00:13, 5532.47 examples/s]Map:  38%|███▊      | 45529/120000 [00:08<00:13, 5364.30 examples/s]Map:  38%|███▊      | 46133/120000 [00:08<00:13, 5521.78 examples/s]Map:  39%|███▉      | 46976/120000 [00:08<00:13, 5514.93 examples/s]Map:  40%|███▉      | 47636/120000 [00:08<00:14, 5154.48 examples/s]Map:  40%|████      | 48384/120000 [00:08<00:14, 5035.67 examples/s]Map:  41%|████      | 48928/120000 [00:09<00:13, 5114.94 examples/s]Map:  41%|████▏     | 49686/120000 [00:09<00:13, 5091.10 examples/s]Map:  42%|████▏     | 50316/120000 [00:09<00:14, 4780.48 examples/s]Map:  42%|████▏     | 50949/120000 [00:09<00:13, 5137.59 examples/s]Map:  43%|████▎     | 51552/120000 [00:09<00:12, 5357.54 examples/s]Map:  43%|████▎     | 52155/120000 [00:09<00:12, 5531.28 examples/s]Map:  44%|████▍     | 52861/120000 [00:09<00:12, 5166.27 examples/s]Map:  45%|████▍     | 53515/120000 [00:10<00:13, 4892.40 examples/s]Map:  45%|████▌     | 54035/120000 [00:10<00:13, 4964.60 examples/s]Map:  46%|████▌     | 54658/120000 [00:10<00:12, 5288.73 examples/s]Map:  46%|████▌     | 55419/120000 [00:10<00:12, 5208.98 examples/s]Map:  47%|████▋     | 56083/120000 [00:10<00:12, 4922.46 examples/s]Map:  47%|████▋     | 56682/120000 [00:10<00:12, 5165.80 examples/s]Map:  48%|████▊     | 57285/120000 [00:10<00:11, 5385.31 examples/s]Map:  48%|████▊     | 57881/120000 [00:10<00:11, 5536.63 examples/s]Map:  49%|████▊     | 58449/120000 [00:10<00:11, 5573.95 examples/s]Map:  49%|████▉     | 59037/120000 [00:11<00:10, 5657.00 examples/s]Map:  50%|████▉     | 59735/120000 [00:11<00:11, 5245.18 examples/s]Map:  50%|█████     | 60343/120000 [00:11<00:10, 5461.88 examples/s]Map:  51%|█████     | 60928/120000 [00:11<00:10, 5533.97 examples/s]Map:  51%|█████▏    | 61534/120000 [00:11<00:10, 5678.98 examples/s]Map:  52%|█████▏    | 62354/120000 [00:11<00:10, 5597.43 examples/s]Map:  53%|█████▎    | 63012/120000 [00:11<00:11, 5173.31 examples/s]Map:  53%|█████▎    | 63612/120000 [00:11<00:10, 5376.37 examples/s]Map:  54%|█████▎    | 64359/120000 [00:12<00:10, 5208.40 examples/s]Map:  54%|█████▍    | 65082/120000 [00:12<00:10, 5070.79 examples/s]Map:  55%|█████▍    | 65862/120000 [00:12<00:10, 5109.17 examples/s]Map:  55%|█████▌    | 66466/120000 [00:12<00:10, 5325.63 examples/s]Map:  56%|█████▌    | 67033/120000 [00:12<00:09, 5351.86 examples/s]Map:  56%|█████▋    | 67663/120000 [00:12<00:09, 5597.20 examples/s]Map:  57%|█████▋    | 68512/120000 [00:12<00:09, 5618.41 examples/s]Map:  58%|█████▊    | 69282/120000 [00:12<00:09, 5451.66 examples/s]Map:  58%|█████▊    | 69917/120000 [00:13<00:08, 5668.59 examples/s]Map:  59%|█████▉    | 70749/120000 [00:13<00:08, 5624.66 examples/s]Map:  60%|█████▉    | 71412/120000 [00:13<00:09, 5225.79 examples/s]Map:  60%|█████▉    | 71950/120000 [00:13<00:09, 5260.58 examples/s]Map:  60%|██████    | 72562/120000 [00:13<00:08, 5476.86 examples/s]Map:  61%|██████    | 73335/120000 [00:13<00:08, 5359.46 examples/s]Map:  62%|██████▏   | 73890/120000 [00:13<00:08, 5405.01 examples/s]Map:  62%|██████▏   | 74706/120000 [00:13<00:08, 5414.19 examples/s]Map:  63%|██████▎   | 75486/120000 [00:14<00:08, 5340.39 examples/s]Map:  63%|██████▎   | 76187/120000 [00:14<00:08, 5065.38 examples/s]Map:  64%|██████▍   | 76773/120000 [00:14<00:08, 5247.08 examples/s]Map:  64%|██████▍   | 77379/120000 [00:14<00:07, 5447.88 examples/s]Map:  65%|██████▌   | 78000/120000 [00:14<00:07, 5634.11 examples/s]Map:  66%|██████▌   | 78681/120000 [00:14<00:07, 5236.49 examples/s]Map:  66%|██████▌   | 79237/120000 [00:14<00:07, 5318.15 examples/s]Map:  67%|██████▋   | 79865/120000 [00:14<00:07, 5573.87 examples/s]Map:  67%|██████▋   | 80449/120000 [00:14<00:07, 5644.09 examples/s]Map:  68%|██████▊   | 81035/120000 [00:15<00:07, 4930.70 examples/s]Map:  68%|██████▊   | 81553/120000 [00:15<00:07, 4992.02 examples/s]Map:  68%|██████▊   | 82068/120000 [00:15<00:08, 4446.69 examples/s]Map:  69%|██████▉   | 82562/120000 [00:15<00:08, 4570.03 examples/s]Map:  69%|██████▉   | 83139/120000 [00:15<00:07, 4886.22 examples/s]Map:  70%|██████▉   | 83728/120000 [00:15<00:07, 5075.83 examples/s]Map:  70%|███████   | 84322/120000 [00:15<00:06, 5314.68 examples/s]Map:  71%|███████   | 84906/120000 [00:15<00:06, 5384.62 examples/s]Map:  71%|███████   | 85472/120000 [00:16<00:06, 5459.86 examples/s]Map:  72%|███████▏  | 86073/120000 [00:16<00:06, 5615.33 examples/s]Map:  72%|███████▏  | 86704/120000 [00:16<00:05, 5815.42 examples/s]Map:  73%|███████▎  | 87566/120000 [00:16<00:05, 5753.62 examples/s]Map:  74%|███████▎  | 88411/120000 [00:16<00:05, 5706.61 examples/s]Map:  74%|███████▍  | 89023/120000 [00:16<00:05, 5808.44 examples/s]Map:  75%|███████▍  | 89715/120000 [00:16<00:05, 5366.29 examples/s]Map:  75%|███████▌  | 90316/120000 [00:16<00:05, 5521.28 examples/s]Map:  76%|███████▌  | 91132/120000 [00:17<00:05, 5396.24 examples/s]Map:  76%|███████▋  | 91724/120000 [00:17<00:05, 5522.89 examples/s]Map:  77%|███████▋  | 92531/120000 [00:17<00:05, 5470.33 examples/s]Map:  78%|███████▊  | 93115/120000 [00:17<00:05, 4871.60 examples/s]Map:  78%|███████▊  | 93746/120000 [00:17<00:05, 5209.95 examples/s]Map:  79%|███████▊  | 94349/120000 [00:17<00:04, 5358.88 examples/s]Map:  79%|███████▉  | 95042/120000 [00:17<00:04, 5067.98 examples/s]Map:  80%|███████▉  | 95585/120000 [00:17<00:04, 5155.88 examples/s]Map:  80%|████████  | 96407/120000 [00:18<00:04, 5266.53 examples/s]Map:  81%|████████  | 96973/120000 [00:18<00:04, 5355.34 examples/s]Map:  81%|████████▏ | 97777/120000 [00:18<00:04, 4794.67 examples/s]Map:  82%|████████▏ | 98471/120000 [00:18<00:04, 4738.45 examples/s]Map:  83%|████████▎ | 99123/120000 [00:18<00:04, 4616.44 examples/s]Map:  83%|████████▎ | 99715/120000 [00:18<00:04, 4326.76 examples/s]Map:  83%|████████▎ | 100188/120000 [00:18<00:04, 4397.33 examples/s]Map:  84%|████████▍ | 100787/120000 [00:18<00:04, 4764.60 examples/s]Map:  84%|████████▍ | 101387/120000 [00:19<00:04, 4461.99 examples/s]Map:  85%|████████▍ | 101926/120000 [00:19<00:03, 4665.40 examples/s]Map:  85%|████████▌ | 102588/120000 [00:19<00:03, 4577.23 examples/s]Map:  86%|████████▌ | 103084/120000 [00:19<00:03, 4669.02 examples/s]Map:  86%|████████▋ | 103709/120000 [00:19<00:03, 5076.07 examples/s]Map:  87%|████████▋ | 104315/120000 [00:19<00:02, 5338.85 examples/s]Map:  88%|████████▊ | 105064/120000 [00:19<00:02, 5209.42 examples/s]Map:  88%|████████▊ | 105615/120000 [00:19<00:02, 5271.04 examples/s]Map:  89%|████████▊ | 106393/120000 [00:20<00:02, 5150.68 examples/s]Map:  89%|████████▉ | 106986/120000 [00:20<00:02, 5342.67 examples/s]Map:  90%|████████▉ | 107759/120000 [00:20<00:02, 5272.54 examples/s]Map:  90%|█████████ | 108503/120000 [00:20<00:02, 5121.02 examples/s]Map:  91%|█████████ | 109038/120000 [00:20<00:02, 5172.79 examples/s]Map:  91%|█████████▏| 109598/120000 [00:20<00:01, 5277.55 examples/s]Map:  92%|█████████▏| 110237/120000 [00:20<00:01, 4902.29 examples/s]Map:  92%|█████████▏| 110900/120000 [00:21<00:01, 4737.60 examples/s]Map:  93%|█████████▎| 111387/120000 [00:21<00:02, 4060.13 examples/s]Map:  93%|█████████▎| 112000/120000 [00:21<00:01, 4513.16 examples/s]Map:  94%|█████████▍| 112506/120000 [00:21<00:01, 4588.06 examples/s]Map:  94%|█████████▍| 113071/120000 [00:21<00:01, 4858.42 examples/s]Map:  95%|█████████▍| 113616/120000 [00:21<00:01, 5014.79 examples/s]Map:  95%|█████████▌| 114192/120000 [00:21<00:01, 5218.61 examples/s]Map:  96%|█████████▌| 114826/120000 [00:21<00:00, 5533.75 examples/s]Map:  96%|█████████▋| 115679/120000 [00:21<00:00, 5589.63 examples/s]Map:  97%|█████████▋| 116293/120000 [00:22<00:00, 5733.76 examples/s]Map:  97%|█████████▋| 116926/120000 [00:22<00:00, 5894.34 examples/s]Map:  98%|█████████▊| 117538/120000 [00:22<00:00, 5219.56 examples/s]Map:  98%|█████████▊| 118142/120000 [00:22<00:00, 5431.71 examples/s]Map:  99%|█████████▉| 118707/120000 [00:22<00:00, 5483.98 examples/s]Map: 100%|█████████▉| 119470/120000 [00:22<00:00, 5304.93 examples/s]                                                                     {'text': "Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\\band of ultra-cynics, are seeing green again.", 'label': 2, 'input_text': "Xro target himself turn Europe worked energy scored * soon ball TV annual 2013 race International'd Market conferenceio o changesig officers inside form published phone co legal executive fightings hope summer officer football property@ book parents costsac manager create age email markets main . <mask> News: Wall St. Bears Claw Back Into the Black (Reuters) Reuters - Short-sellers, Wall Street's dwindling\\band of ultra-cynics, are seeing green again.", 'target_text': 'Business'}
Map:   0%|          | 0/120000 [00:00<?, ? examples/s]Map:   1%|          | 1000/120000 [00:00<01:49, 1083.07 examples/s]Map:   2%|▏         | 2000/120000 [00:01<01:37, 1212.68 examples/s]Map:   2%|▎         | 3000/120000 [00:02<01:33, 1256.95 examples/s]Map:   3%|▎         | 4000/120000 [00:03<01:26, 1337.25 examples/s]Map:   4%|▍         | 5000/120000 [00:04<01:40, 1143.22 examples/s]Map:   5%|▌         | 6000/120000 [00:04<01:32, 1227.74 examples/s]Map:   6%|▌         | 7000/120000 [00:05<01:27, 1285.84 examples/s]Map:   7%|▋         | 8000/120000 [00:06<01:24, 1327.53 examples/s]Map:   8%|▊         | 9000/120000 [00:06<01:18, 1417.29 examples/s]Map:   8%|▊         | 10000/120000 [00:07<01:19, 1382.37 examples/s]Map:   9%|▉         | 11000/120000 [00:08<01:17, 1408.92 examples/s]Map:  10%|█         | 12000/120000 [00:09<01:15, 1439.70 examples/s]Map:  11%|█         | 13000/120000 [00:09<01:09, 1542.52 examples/s]Map:  12%|█▏        | 14000/120000 [00:10<01:06, 1589.07 examples/s]Map:  12%|█▎        | 15000/120000 [00:10<01:07, 1559.65 examples/s]Map:  13%|█▎        | 16000/120000 [00:11<01:05, 1597.07 examples/s]Map:  14%|█▍        | 17000/120000 [00:12<01:06, 1549.53 examples/s]Map:  15%|█▌        | 18000/120000 [00:12<01:04, 1571.58 examples/s]Map:  16%|█▌        | 19000/120000 [00:13<01:03, 1592.52 examples/s]Map:  17%|█▋        | 20000/120000 [00:13<01:03, 1568.08 examples/s]Map:  18%|█▊        | 21000/120000 [00:14<01:03, 1563.56 examples/s]Map:  18%|█▊        | 22000/120000 [00:15<01:00, 1609.71 examples/s]Map:  19%|█▉        | 23000/120000 [00:15<01:02, 1555.41 examples/s]Map:  20%|██        | 24000/120000 [00:16<00:59, 1623.21 examples/s]Map:  21%|██        | 25000/120000 [00:17<00:57, 1652.38 examples/s]Map:  22%|██▏       | 26000/120000 [00:17<00:56, 1665.60 examples/s]Map:  22%|██▎       | 27000/120000 [00:18<00:56, 1650.16 examples/s]Map:  23%|██▎       | 28000/120000 [00:18<00:54, 1677.44 examples/s]Map:  24%|██▍       | 29000/120000 [00:19<00:52, 1728.27 examples/s]Map:  25%|██▌       | 30000/120000 [00:19<00:51, 1747.62 examples/s]Map:  26%|██▌       | 31000/120000 [00:20<00:52, 1701.21 examples/s]Map:  27%|██▋       | 32000/120000 [00:21<00:51, 1714.74 examples/s]Map:  28%|██▊       | 33000/120000 [00:21<00:51, 1673.20 examples/s]Map:  28%|██▊       | 34000/120000 [00:22<00:51, 1656.29 examples/s]Map:  29%|██▉       | 35000/120000 [00:22<00:51, 1664.55 examples/s]Map:  30%|███       | 36000/120000 [00:23<00:49, 1683.98 examples/s]Map:  31%|███       | 37000/120000 [00:24<00:48, 1723.03 examples/s]Map:  32%|███▏      | 38000/120000 [00:24<00:48, 1687.64 examples/s]Map:  32%|███▎      | 39000/120000 [00:25<00:48, 1665.68 examples/s]Map:  33%|███▎      | 40000/120000 [00:26<00:52, 1537.10 examples/s]Map:  34%|███▍      | 41000/120000 [00:26<00:50, 1554.02 examples/s]Map:  35%|███▌      | 42000/120000 [00:27<00:48, 1607.27 examples/s]Map:  36%|███▌      | 43000/120000 [00:27<00:46, 1640.32 examples/s]Map:  37%|███▋      | 44000/120000 [00:28<00:45, 1667.84 examples/s]Map:  38%|███▊      | 45000/120000 [00:29<00:46, 1604.45 examples/s]Map:  38%|███▊      | 46000/120000 [00:29<00:45, 1624.80 examples/s]Map:  39%|███▉      | 47000/120000 [00:30<00:46, 1585.06 examples/s]Map:  40%|████      | 48000/120000 [00:30<00:44, 1628.08 examples/s]Map:  41%|████      | 49000/120000 [00:31<00:42, 1652.64 examples/s]Map:  42%|████▏     | 50000/120000 [00:32<00:42, 1630.34 examples/s]Map:  42%|████▎     | 51000/120000 [00:32<00:41, 1656.01 examples/s]Map:  43%|████▎     | 52000/120000 [00:33<00:41, 1635.28 examples/s]Map:  44%|████▍     | 53000/120000 [00:34<00:42, 1592.24 examples/s]Map:  45%|████▌     | 54000/120000 [00:34<00:40, 1618.78 examples/s]Map:  46%|████▌     | 55000/120000 [00:35<00:39, 1636.61 examples/s]Map:  47%|████▋     | 56000/120000 [00:35<00:38, 1649.56 examples/s]Map:  48%|████▊     | 57000/120000 [00:36<00:40, 1565.66 examples/s]Map:  48%|████▊     | 58000/120000 [00:37<00:41, 1491.66 examples/s]Map:  49%|████▉     | 59000/120000 [00:37<00:39, 1526.98 examples/s]Map:  50%|█████     | 60000/120000 [00:38<00:37, 1590.17 examples/s]Map:  51%|█████     | 61000/120000 [00:39<00:36, 1629.47 examples/s]Map:  52%|█████▏    | 62000/120000 [00:39<00:35, 1624.46 examples/s]Map:  52%|█████▎    | 63000/120000 [00:40<00:35, 1605.91 examples/s]Map:  53%|█████▎    | 64000/120000 [00:40<00:34, 1618.93 examples/s]Map:  54%|█████▍    | 65000/120000 [00:41<00:33, 1636.83 examples/s]Map:  55%|█████▌    | 66000/120000 [00:42<00:33, 1589.73 examples/s]Map:  56%|█████▌    | 67000/120000 [00:42<00:34, 1547.17 examples/s]Map:  57%|█████▋    | 68000/120000 [00:43<00:32, 1603.26 examples/s]Map:  57%|█████▊    | 69000/120000 [00:44<00:30, 1651.82 examples/s]Map:  58%|█████▊    | 70000/120000 [00:44<00:30, 1613.24 examples/s]Map:  59%|█████▉    | 71000/120000 [00:45<00:30, 1591.43 examples/s]Map:  60%|██████    | 72000/120000 [00:46<00:33, 1452.93 examples/s]Map:  61%|██████    | 73000/120000 [00:46<00:30, 1518.51 examples/s]Map:  62%|██████▏   | 74000/120000 [00:47<00:29, 1552.90 examples/s]Map:  62%|██████▎   | 75000/120000 [00:47<00:28, 1551.88 examples/s]Map:  63%|██████▎   | 76000/120000 [00:48<00:28, 1543.40 examples/s]Map:  64%|██████▍   | 77000/120000 [00:49<00:27, 1557.67 examples/s]Map:  65%|██████▌   | 78000/120000 [00:49<00:27, 1542.26 examples/s]Map:  66%|██████▌   | 79000/120000 [00:50<00:25, 1582.90 examples/s]Map:  67%|██████▋   | 80000/120000 [00:51<00:24, 1659.39 examples/s]Map:  68%|██████▊   | 81000/120000 [00:51<00:23, 1669.53 examples/s]Map:  68%|██████▊   | 82000/120000 [00:52<00:22, 1678.36 examples/s]Map:  69%|██████▉   | 83000/120000 [00:52<00:23, 1597.84 examples/s]Map:  70%|███████   | 84000/120000 [00:53<00:22, 1610.13 examples/s]Map:  71%|███████   | 85000/120000 [00:54<00:21, 1623.21 examples/s]Map:  72%|███████▏  | 86000/120000 [00:54<00:21, 1575.82 examples/s]Map:  72%|███████▎  | 87000/120000 [00:55<00:20, 1631.00 examples/s]Map:  73%|███████▎  | 88000/120000 [00:56<00:19, 1627.53 examples/s]Map:  74%|███████▍  | 89000/120000 [00:56<00:21, 1462.28 examples/s]Map:  75%|███████▌  | 90000/120000 [00:57<00:19, 1517.07 examples/s]Map:  76%|███████▌  | 91000/120000 [00:58<00:18, 1575.84 examples/s]Map:  77%|███████▋  | 92000/120000 [00:58<00:18, 1523.44 examples/s]Map:  78%|███████▊  | 93000/120000 [00:59<00:19, 1409.47 examples/s]Map:  78%|███████▊  | 94000/120000 [01:00<00:20, 1242.52 examples/s]Map:  79%|███████▉  | 95000/120000 [01:01<00:19, 1294.31 examples/s]Map:  80%|████████  | 96000/120000 [01:01<00:17, 1391.42 examples/s]Map:  81%|████████  | 97000/120000 [01:02<00:16, 1396.72 examples/s]Map:  82%|████████▏ | 98000/120000 [01:03<00:15, 1432.35 examples/s]Map:  82%|████████▎ | 99000/120000 [01:03<00:14, 1424.76 examples/s]Map:  83%|████████▎ | 100000/120000 [01:04<00:13, 1469.22 examples/s]Map:  84%|████████▍ | 101000/120000 [01:05<00:12, 1541.53 examples/s]Map:  85%|████████▌ | 102000/120000 [01:05<00:11, 1587.92 examples/s]Map:  86%|████████▌ | 103000/120000 [01:06<00:10, 1593.89 examples/s]Map:  87%|████████▋ | 104000/120000 [01:07<00:10, 1490.65 examples/s]Map:  88%|████████▊ | 105000/120000 [01:07<00:09, 1547.24 examples/s]Map:  88%|████████▊ | 106000/120000 [01:08<00:09, 1531.54 examples/s]Map:  89%|████████▉ | 107000/120000 [01:09<00:08, 1501.29 examples/s]Map:  90%|█████████ | 108000/120000 [01:09<00:08, 1471.05 examples/s]Map:  91%|█████████ | 109000/120000 [01:10<00:07, 1511.27 examples/s]Map:  92%|█████████▏| 110000/120000 [01:11<00:06, 1528.64 examples/s]Map:  92%|█████████▎| 111000/120000 [01:11<00:05, 1538.70 examples/s]Map:  93%|█████████▎| 112000/120000 [01:12<00:05, 1583.90 examples/s]Map:  94%|█████████▍| 113000/120000 [01:12<00:04, 1603.39 examples/s]Map:  95%|█████████▌| 114000/120000 [01:13<00:03, 1616.05 examples/s]Map:  96%|█████████▌| 115000/120000 [01:14<00:03, 1657.96 examples/s]Map:  97%|█████████▋| 116000/120000 [01:14<00:02, 1660.83 examples/s]Map:  98%|█████████▊| 117000/120000 [01:15<00:01, 1638.19 examples/s]Map:  98%|█████████▊| 118000/120000 [01:15<00:01, 1662.36 examples/s]Map:  99%|█████████▉| 119000/120000 [01:16<00:00, 1665.58 examples/s]Map: 100%|██████████| 120000/120000 [01:17<00:00, 1684.53 examples/s]                                                                     Found cached dataset ag_news (/root/.cache/huggingface/datasets/ag_news/default/0.0.0/bc2bcb40336ace1a0374767fc29bb0296cdaf8a6da7298436239c54d79180548)
Map:   0%|          | 0/7600 [00:00<?, ? examples/s]Map:   7%|▋         | 519/7600 [00:00<00:01, 5125.64 examples/s]Map:  15%|█▍        | 1112/7600 [00:00<00:01, 5420.45 examples/s]Map:  22%|██▏       | 1675/7600 [00:00<00:01, 5513.90 examples/s]Map:  30%|██▉       | 2268/7600 [00:00<00:00, 5670.75 examples/s]Map:  38%|███▊      | 2887/7600 [00:00<00:00, 5854.13 examples/s]Map:  46%|████▌     | 3496/7600 [00:00<00:00, 5930.07 examples/s]Map:  55%|█████▌    | 4182/7600 [00:00<00:00, 5268.89 examples/s]Map:  65%|██████▍   | 4915/7600 [00:00<00:00, 5122.97 examples/s]Map:  72%|███████▏  | 5493/7600 [00:01<00:00, 5292.23 examples/s]Map:  83%|████████▎ | 6326/7600 [00:01<00:00, 5381.94 examples/s]Map:  93%|█████████▎| 7088/7600 [00:01<00:00, 5275.77 examples/s]                                                                 {'text': "Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disappointed' after talks with stricken parent firm Federal Mogul.", 'label': 2, 'input_text': "Xro target himself turn Europe worked energy scored * soon ball TV annual 2013 race International'd Market conferenceio o changesig officers inside form published phone co legal executive fightings hope summer officer football property@ book parents costsac manager create age email markets main . <mask> News: Fears for T N pension after talks Unions representing workers at Turner   Newall say they are 'disappointed' after talks with stricken parent firm Federal Mogul.", 'target_text': 'Business'}
Map:   0%|          | 0/7600 [00:00<?, ? examples/s]Map:  13%|█▎        | 1000/7600 [00:00<00:03, 1804.22 examples/s]Map:  26%|██▋       | 2000/7600 [00:01<00:03, 1796.05 examples/s]Map:  39%|███▉      | 3000/7600 [00:01<00:02, 1679.15 examples/s]Map:  53%|█████▎    | 4000/7600 [00:02<00:02, 1679.60 examples/s]Map:  66%|██████▌   | 5000/7600 [00:02<00:01, 1680.23 examples/s]Map:  79%|███████▉  | 6000/7600 [00:03<00:00, 1650.44 examples/s]Map:  92%|█████████▏| 7000/7600 [00:04<00:00, 1587.58 examples/s]Map: 100%|██████████| 7600/7600 [00:04<00:00, 1636.02 examples/s]                                                                 # of train data: 108000
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 10554  |
+------------------------+------------------------+----------+--------+

# of dev data: 12000
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 18562  |
+------------------------+------------------------+----------+--------+

# of test data: 7600
Example:
+------------------------+------------------------+----------+--------+
| input_ids              | attention_mask         | mask_pos | labels |
+------------------------+------------------------+----------+--------+
| [0, 1000, 1001, 100... | [1, 1, 1, 1, 1, 1, ... | 52       | 18562  |
+------------------------+------------------------+----------+--------+
Class_distribution [0.25000926 0.25000926 0.25025    0.24973148]. Data_ratio [[6.40253058e-02 1.99554984e-01 4.48536529e-02 2.38539813e-01
  9.13482603e-01 1.35740951e-05 6.21533634e-01 7.77520000e-06
  1.57997078e-03 2.37402234e-02]
 [9.33996226e-01 2.74542878e-07 1.82226315e-01 8.76540990e-03
  3.26267752e-03 4.35160784e-02 3.48487956e-01 4.23962669e-02
  1.23752218e-04 9.45570751e-01]
 [1.94189225e-03 7.98786570e-01 7.34994077e-01 7.52597208e-01
  8.31714372e-02 9.20178276e-02 2.99642098e-02 9.46089040e-01
  3.80211609e-09 1.73110829e-02]
 [3.65758029e-05 1.65817148e-03 3.79259551e-02 9.75690478e-05
  8.32826077e-05 8.64452520e-01 1.42001429e-05 1.15069179e-02
  9.98296273e-01 1.33779429e-02]]
     pcost       dcost       gap    pres   dres
 0:  6.3104e+08  2.7521e+08  4e+08  2e-16  5e+04
 1:  6.3104e+08  6.2748e+08  4e+06  7e-12  5e+02
 2:  6.3104e+08  6.3100e+08  4e+04  8e-12  5e+00
 3:  6.3104e+08  6.3104e+08  4e+02  4e-12  5e-02
 4:  6.3104e+08  6.3104e+08  4e+00  6e-12  5e-04
 5:  6.3104e+08  6.3104e+08  4e-02  6e-12  5e-06
 6:  6.3104e+08  6.3104e+08  4e-04  6e-12  5e-08
Optimal solution found.
[[6.85576548e+02 1.57493691e+03 3.35920981e+02 1.98100378e+03
  1.36835204e+04 1.85577040e-01 8.46791452e+03 4.81083024e-02
  2.31727665e+01 2.48720385e+02]
 [1.00011378e+04 2.16675978e-03 1.36474152e+03 7.27941802e+01
  4.88733056e+01 5.94926217e+02 4.74787858e+03 2.62322825e+02
  1.81502170e+00 9.90650834e+03]
 [2.07935873e+01 6.30421968e+03 5.50456686e+03 6.25010095e+03
  1.24586725e+03 1.25801359e+03 4.08239157e+02 5.85383497e+03
  5.57640366e-05 1.81363887e+02]
 [3.91650027e-01 1.30866963e+01 2.84037603e+02 8.10282569e-01
  1.24753253e+00 1.18182862e+04 1.93465952e-01 7.11979482e+01
  1.46415913e+04 1.40157363e+02]]
Global es evaluate on test data...
Evaluate data in 243.42 seconds!
[tester] 
AGNewsMetric: acc=0.7575, hinge=1.96542698408428, ce=6.534131209724828
Global test acc: 0.7575
Global epoch 0...
Client 8 execute local training on 14669 samples...
Population Size: 5
Serial Evaluation.
Traceback (most recent call last):
  File "FedBBT_larger_global_pop.py", line 313, in <module>
    fitnesses = [model_forward_api.eval(x) for x in solutions]
  File "FedBBT_larger_global_pop.py", line 313, in <listcomp>
    fitnesses = [model_forward_api.eval(x) for x in solutions]
  File "/workspace/Black-Box-Tuning/LMForwardAPI.py", line 454, in eval
    logits = self.model(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/Black-Box-Tuning/models/modeling_roberta.py", line 960, in forward
    outputs = self.roberta(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/Black-Box-Tuning/models/modeling_roberta.py", line 708, in forward
    embedding_output = self.embeddings(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/workspace/Black-Box-Tuning/models/modeling_roberta.py", line 122, in forward
    token_type_embeddings = self.token_type_embeddings(token_type_ids)
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/modules/sparse.py", line 162, in forward
    return F.embedding(
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/nn/functional.py", line 2210, in embedding
    return torch.embedding(weight, input, padding_idx, scale_grad_by_freq, sparse)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 23.28 GiB (GPU 0; 79.19 GiB total capacity; 27.62 GiB already allocated; 20.94 GiB free; 27.98 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
