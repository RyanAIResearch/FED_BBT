Loading checkpoint shards:   0%|          | 0/2 [00:00<?, ?it/s]Loading checkpoint shards:  50%|█████     | 1/2 [00:10<00:10, 10.76s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  6.48s/it]Loading checkpoint shards: 100%|██████████| 2/2 [00:14<00:00,  7.12s/it]
Found cached dataset glue (/root/.cache/huggingface/datasets/glue/sst2/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
Map:   0%|          | 0/67349 [00:00<?, ? examples/s]Map:   1%|          | 603/67349 [00:00<00:11, 5970.38 examples/s]Map:   2%|▏         | 1400/67349 [00:00<00:12, 5420.66 examples/s]Map:   3%|▎         | 2000/67349 [00:00<00:11, 5513.05 examples/s]Map:   4%|▍         | 2608/67349 [00:00<00:11, 5710.70 examples/s]Map:   5%|▌         | 3488/67349 [00:00<00:11, 5775.09 examples/s]Map:   6%|▋         | 4332/67349 [00:00<00:11, 5715.63 examples/s]Map:   7%|▋         | 4947/67349 [00:00<00:10, 5830.05 examples/s]Map:   9%|▊         | 5825/67349 [00:01<00:10, 5835.92 examples/s]Map:  10%|▉         | 6709/67349 [00:01<00:10, 5852.49 examples/s]Map:  11%|█         | 7306/67349 [00:01<00:10, 5832.55 examples/s]Map:  12%|█▏        | 7920/67349 [00:01<00:10, 5908.28 examples/s]Map:  13%|█▎        | 8802/67349 [00:01<00:09, 5893.13 examples/s]Map:  14%|█▍        | 9682/67349 [00:01<00:09, 5879.50 examples/s]Map:  16%|█▌        | 10562/67349 [00:01<00:09, 5871.42 examples/s]Map:  17%|█▋        | 11398/67349 [00:01<00:09, 5774.76 examples/s]Map:  18%|█▊        | 12236/67349 [00:02<00:09, 5713.68 examples/s]Map:  19%|█▉        | 12850/67349 [00:02<00:09, 5808.52 examples/s]Map:  20%|██        | 13703/67349 [00:02<00:09, 5765.59 examples/s]Map:  21%|██        | 14308/67349 [00:02<00:09, 5760.17 examples/s]Map:  22%|██▏       | 14926/67349 [00:02<00:08, 5862.92 examples/s]Map:  23%|██▎       | 15785/67349 [00:02<00:08, 5811.29 examples/s]Map:  25%|██▍       | 16648/67349 [00:02<00:08, 5789.18 examples/s]Map:  26%|██▌       | 17516/67349 [00:03<00:08, 5784.79 examples/s]Map:  27%|██▋       | 18401/67349 [00:03<00:08, 5819.15 examples/s]Map:  28%|██▊       | 19000/67349 [00:03<00:08, 5811.80 examples/s]Map:  29%|██▉       | 19611/67349 [00:03<00:08, 5881.80 examples/s]Map:  30%|███       | 20494/67349 [00:03<00:07, 5880.08 examples/s]Map:  32%|███▏      | 21377/67349 [00:03<00:07, 5878.78 examples/s]Map:  33%|███▎      | 21992/67349 [00:03<00:07, 5941.26 examples/s]Map:  34%|███▍      | 22874/67349 [00:03<00:07, 5918.67 examples/s]Map:  35%|███▌      | 23754/67349 [00:04<00:07, 5899.35 examples/s]Map:  37%|███▋      | 24633/67349 [00:04<00:07, 5884.29 examples/s]Map:  38%|███▊      | 25511/67349 [00:04<00:07, 5871.74 examples/s]Map:  39%|███▉      | 26393/67349 [00:04<00:06, 5871.77 examples/s]Map:  40%|████      | 27000/67349 [00:04<00:06, 5856.11 examples/s]Map:  41%|████      | 27609/67349 [00:04<00:06, 5909.28 examples/s]Map:  42%|████▏     | 28491/67349 [00:04<00:06, 5896.61 examples/s]Map:  44%|████▎     | 29368/67349 [00:05<00:06, 5875.68 examples/s]Map:  45%|████▍     | 29979/67349 [00:05<00:06, 5929.16 examples/s]Map:  46%|████▌     | 30861/67349 [00:05<00:06, 5909.17 examples/s]Map:  47%|████▋     | 31738/67349 [00:05<00:06, 5886.39 examples/s]Map:  48%|████▊     | 32613/67349 [00:05<00:05, 5828.64 examples/s]Map:  50%|████▉     | 33492/67349 [00:05<00:05, 5835.64 examples/s]Map:  51%|█████     | 34374/67349 [00:05<00:05, 5845.58 examples/s]Map:  52%|█████▏    | 34987/67349 [00:05<00:05, 5908.68 examples/s]Map:  53%|█████▎    | 35847/67349 [00:06<00:05, 5846.61 examples/s]Map:  55%|█████▍    | 36723/67349 [00:06<00:05, 5841.83 examples/s]Map:  56%|█████▌    | 37614/67349 [00:06<00:05, 5849.62 examples/s]Map:  57%|█████▋    | 38496/67349 [00:06<00:04, 5854.71 examples/s]Map:  58%|█████▊    | 39372/67349 [00:06<00:04, 5847.86 examples/s]Map:  59%|█████▉    | 39983/67349 [00:06<00:04, 5903.96 examples/s]Map:  61%|██████    | 40866/67349 [00:06<00:04, 5894.24 examples/s]Map:  62%|██████▏   | 41754/67349 [00:07<00:04, 5897.54 examples/s]Map:  63%|██████▎   | 42641/67349 [00:07<00:04, 5899.41 examples/s]Map:  65%|██████▍   | 43523/67349 [00:07<00:04, 5889.15 examples/s]Map:  66%|██████▌   | 44401/67349 [00:07<00:03, 5874.51 examples/s]Map:  67%|██████▋   | 45000/67349 [00:07<00:03, 5857.04 examples/s]Map:  68%|██████▊   | 45609/67349 [00:07<00:03, 5910.91 examples/s]Map:  69%|██████▉   | 46492/67349 [00:07<00:03, 5899.27 examples/s]Map:  70%|███████   | 47374/67349 [00:08<00:03, 5889.43 examples/s]Map:  71%|███████▏  | 47988/67349 [00:08<00:03, 5945.94 examples/s]Map:  73%|███████▎  | 48867/67349 [00:08<00:03, 5915.55 examples/s]Map:  74%|███████▍  | 49735/67349 [00:08<00:03, 5869.95 examples/s]Map:  75%|███████▌  | 50616/67349 [00:08<00:02, 5866.69 examples/s]Map:  76%|███████▋  | 51493/67349 [00:08<00:02, 5858.62 examples/s]Map:  78%|███████▊  | 52375/67349 [00:08<00:02, 5862.78 examples/s]Map:  79%|███████▊  | 52988/67349 [00:09<00:02, 5921.42 examples/s]Map:  80%|███████▉  | 53868/67349 [00:09<00:02, 5901.68 examples/s]Map:  81%|████████▏ | 54747/67349 [00:09<00:02, 5886.02 examples/s]Map:  83%|████████▎ | 55630/67349 [00:09<00:01, 5881.87 examples/s]Map:  84%|████████▍ | 56512/67349 [00:09<00:01, 5878.35 examples/s]Map:  85%|████████▌ | 57392/67349 [00:09<00:01, 5871.95 examples/s]Map:  86%|████████▌ | 58000/67349 [00:09<00:01, 5826.78 examples/s]Map:  87%|████████▋ | 58610/67349 [00:10<00:01, 5889.88 examples/s]Map:  88%|████████▊ | 59437/67349 [00:10<00:01, 5758.80 examples/s]Map:  90%|████████▉ | 60299/67349 [00:10<00:01, 5749.43 examples/s]Map:  91%|█████████ | 61062/67349 [00:10<00:01, 5536.36 examples/s]Map:  92%|█████████▏| 61673/67349 [00:10<00:01, 5667.06 examples/s]Map:  92%|█████████▏| 62246/67349 [00:10<00:00, 5680.51 examples/s]Map:  93%|█████████▎| 62860/67349 [00:10<00:00, 5800.48 examples/s]Map:  95%|█████████▍| 63684/67349 [00:10<00:00, 5685.37 examples/s]Map:  95%|█████████▌| 64258/67349 [00:11<00:00, 5696.16 examples/s]Map:  96%|█████████▋| 64873/67349 [00:11<00:00, 5815.70 examples/s]Map:  98%|█████████▊| 65757/67349 [00:11<00:00, 5839.33 examples/s]Map:  99%|█████████▉| 66640/67349 [00:11<00:00, 5850.71 examples/s]Map: 100%|██████████| 67349/67349 [00:11<00:00, 5658.38 examples/s]                                                                   Example in train set:
{'sentence': 'hide new secretions from the parental units ', 'label': 0, 'idx': 0, 'input_text': 'What is the sentiment of this sentence: iedER statfigme von interroidater their bet ein}\\"> sub op donty try Pro tra sameep two nameoldlet simsp avbreblemey could cor accayscreurrsi constues}$View act bo ко som aboutland . hide new secretions from the parental units  .', 'target_text': 'negative'}
Map:   0%|          | 0/67349 [00:00<?, ? examples/s]Map:   1%|▏         | 1000/67349 [00:00<00:12, 5191.42 examples/s]Map:   3%|▎         | 2000/67349 [00:00<00:12, 5417.44 examples/s]Map:   4%|▍         | 3000/67349 [00:00<00:11, 5463.05 examples/s]Map:   6%|▌         | 4000/67349 [00:00<00:16, 3853.72 examples/s]Map:   7%|▋         | 5000/67349 [00:01<00:14, 4306.10 examples/s]Map:   9%|▉         | 6000/67349 [00:01<00:13, 4631.20 examples/s]Map:  10%|█         | 7000/67349 [00:01<00:13, 4471.42 examples/s]Map:  12%|█▏        | 8000/67349 [00:01<00:13, 4425.53 examples/s]Map:  13%|█▎        | 9000/67349 [00:01<00:12, 4661.98 examples/s]Map:  15%|█▍        | 10000/67349 [00:02<00:11, 4809.96 examples/s]Map:  16%|█▋        | 11000/67349 [00:02<00:11, 4998.84 examples/s]Map:  18%|█▊        | 12000/67349 [00:02<00:10, 5169.85 examples/s]Map:  19%|█▉        | 13000/67349 [00:02<00:10, 5314.28 examples/s]Map:  21%|██        | 14000/67349 [00:02<00:10, 5249.29 examples/s]Map:  22%|██▏       | 15000/67349 [00:03<00:10, 5055.41 examples/s]Map:  24%|██▍       | 16000/67349 [00:03<00:10, 5076.60 examples/s]Map:  25%|██▌       | 17000/67349 [00:03<00:09, 5170.47 examples/s]Map:  27%|██▋       | 18000/67349 [00:03<00:09, 5172.77 examples/s]Map:  28%|██▊       | 19000/67349 [00:03<00:09, 5227.12 examples/s]Map:  30%|██▉       | 20000/67349 [00:04<00:10, 4522.10 examples/s]Map:  31%|███       | 21000/67349 [00:04<00:09, 4812.98 examples/s]Map:  33%|███▎      | 22000/67349 [00:04<00:09, 4897.58 examples/s]Map:  34%|███▍      | 23000/67349 [00:04<00:09, 4764.94 examples/s]Map:  36%|███▌      | 24000/67349 [00:04<00:08, 4842.51 examples/s]Map:  37%|███▋      | 25000/67349 [00:05<00:08, 4890.64 examples/s]Map:  39%|███▊      | 26000/67349 [00:05<00:08, 5083.03 examples/s]Map:  40%|████      | 27000/67349 [00:05<00:07, 5168.64 examples/s]Map:  42%|████▏     | 28000/67349 [00:05<00:07, 5125.27 examples/s]Map:  43%|████▎     | 29000/67349 [00:05<00:07, 5258.43 examples/s]Map:  45%|████▍     | 30000/67349 [00:06<00:07, 5209.32 examples/s]Map:  46%|████▌     | 31000/67349 [00:06<00:07, 5034.71 examples/s]Map:  48%|████▊     | 32000/67349 [00:06<00:06, 5185.87 examples/s]Map:  49%|████▉     | 33000/67349 [00:06<00:07, 4542.27 examples/s]Map:  50%|█████     | 34000/67349 [00:06<00:06, 4774.88 examples/s]Map:  52%|█████▏    | 35000/67349 [00:07<00:06, 4976.54 examples/s]Map:  53%|█████▎    | 36000/67349 [00:07<00:06, 5018.93 examples/s]Map:  55%|█████▍    | 37000/67349 [00:07<00:06, 4982.33 examples/s]Map:  56%|█████▋    | 38000/67349 [00:07<00:05, 4997.33 examples/s]Map:  58%|█████▊    | 39000/67349 [00:07<00:05, 4933.08 examples/s]Map:  59%|█████▉    | 40000/67349 [00:08<00:05, 5148.50 examples/s]Map:  61%|██████    | 41000/67349 [00:08<00:05, 5222.90 examples/s]Map:  62%|██████▏   | 42000/67349 [00:08<00:04, 5339.12 examples/s]Map:  64%|██████▍   | 43000/67349 [00:08<00:04, 5388.25 examples/s]Map:  65%|██████▌   | 44000/67349 [00:08<00:04, 5460.41 examples/s]Map:  67%|██████▋   | 45000/67349 [00:09<00:05, 4105.66 examples/s]Map:  68%|██████▊   | 46000/67349 [00:09<00:05, 4139.16 examples/s]Map:  70%|██████▉   | 47000/67349 [00:09<00:04, 4459.22 examples/s]Map:  71%|███████▏  | 48000/67349 [00:09<00:04, 4604.65 examples/s]Map:  73%|███████▎  | 49000/67349 [00:10<00:03, 4810.98 examples/s]Map:  74%|███████▍  | 50000/67349 [00:10<00:03, 4859.35 examples/s]Map:  76%|███████▌  | 51000/67349 [00:10<00:03, 5000.22 examples/s]Map:  77%|███████▋  | 52000/67349 [00:10<00:03, 4960.30 examples/s]Map:  79%|███████▊  | 53000/67349 [00:10<00:03, 4665.16 examples/s]Map:  80%|████████  | 54000/67349 [00:11<00:02, 4812.69 examples/s]Map:  82%|████████▏ | 55000/67349 [00:11<00:02, 4313.05 examples/s]Map:  83%|████████▎ | 56000/67349 [00:11<00:02, 4606.01 examples/s]Map:  85%|████████▍ | 57000/67349 [00:11<00:02, 4812.49 examples/s]Map:  86%|████████▌ | 58000/67349 [00:11<00:01, 4985.18 examples/s]Map:  88%|████████▊ | 59000/67349 [00:12<00:01, 5123.80 examples/s]Map:  89%|████████▉ | 60000/67349 [00:12<00:01, 5218.11 examples/s]Map:  91%|█████████ | 61000/67349 [00:12<00:01, 5297.21 examples/s]Map:  92%|█████████▏| 62000/67349 [00:12<00:00, 5360.16 examples/s]Map:  94%|█████████▎| 63000/67349 [00:12<00:00, 5402.40 examples/s]Map:  95%|█████████▌| 64000/67349 [00:12<00:00, 5431.50 examples/s]Map:  97%|█████████▋| 65000/67349 [00:13<00:00, 5451.01 examples/s]Map:  98%|█████████▊| 66000/67349 [00:13<00:00, 4662.61 examples/s]Map:  99%|█████████▉| 67000/67349 [00:13<00:00, 4905.90 examples/s]                                                                   Found cached dataset glue (/root/.cache/huggingface/datasets/glue/sst2/1.0.0/dacbe3125aa31d7f70367a07a8a9e72a5a0bfeb5fc42e75c9db75b96da6053ad)
Map:   0%|          | 0/872 [00:00<?, ? examples/s]Map:  69%|██████▊   | 599/872 [00:00<00:00, 5934.18 examples/s]                                                               Example in validation set:
{'sentence': "it 's a charming and often affecting journey . ", 'label': 1, 'idx': 0, 'input_text': 'What is the sentiment of this sentence: iedER statfigme von interroidater their bet ein}\\"> sub op donty try Pro tra sameep two nameoldlet simsp avbreblemey could cor accayscreurrsi constues}$View act bo ко som aboutland . it \'s a charming and often affecting journey .  .', 'target_text': 'positive'}
Map:   0%|          | 0/872 [00:00<?, ? examples/s]Map: 100%|██████████| 872/872 [00:00<00:00, 4270.41 examples/s]                                                               # of train data: 80
Example:
+------------------------------+------------------------------+--------+
| input_ids                    | attention_mask               | labels |
+------------------------------+------------------------------+--------+
| [1, 1724, 338, 278, 19688... | [1, 1, 1, 1, 1, 1, 1, 1, ... | 8178   |
+------------------------------+------------------------------+--------+

# of dev data: 80
Example:
+------------------------------+------------------------------+--------+
| input_ids                    | attention_mask               | labels |
+------------------------------+------------------------------+--------+
| [1, 1724, 338, 278, 19688... | [1, 1, 1, 1, 1, 1, 1, 1, ... | 6374   |
+------------------------------+------------------------------+--------+

# of test data: 872
Example:
+------------------------------+------------------------------+--------+
| input_ids                    | attention_mask               | labels |
+------------------------------+------------------------------+--------+
| [1, 1724, 338, 278, 19688... | [1, 1, 1, 1, 1, 1, 1, 1, ... | 6374   |
+------------------------------+------------------------------+--------+
/root/anaconda3/envs/bbt/lib/python3.8/site-packages/transformers/optimization.py:411: FutureWarning: This implementation of AdamW is deprecated and will be removed in a future version. Use the PyTorch implementation torch.optim.AdamW instead, or set `no_deprecation_warning=True` to disable this warning
  warnings.warn(
Evaluate data in 83.18 seconds!
[tester] 
SST2Metric: acc=0.5802752293577982, hinge=1.7493385404621788, ce=12.454310452172516
Global test acc: 0.5803
Global epoch 0...
Client 4 execute local training on 8 samples...
Traceback (most recent call last):
  File "FedTuning.py", line 227, in <module>
    optimizer.step()
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/optim/optimizer.py", line 280, in wrapper
    out = func(*args, **kwargs)
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/root/anaconda3/envs/bbt/lib/python3.8/site-packages/transformers/optimization.py", line 457, in step
    state["exp_avg_sq"] = torch.zeros_like(p)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 79.19 GiB total capacity; 78.43 GiB already allocated; 60.81 MiB free; 78.63 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
